#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Created on Tue Jun 14 19:54:09 2022

@author: luiza.maciel
"""
import numpy as np
from scipy.integrate import solve_ivp,odeint
from math import radians,degrees
import matplotlib.pyplot as plt
from math import exp
from scipy.optimize import curve_fit
from scipy import signal
from edos import volume


def find_nearest(array, value):
    idx = (np.abs(array - value)).argmin()
    if array[idx]<=value:
        return idx
    else:
        return idx-1
    
et = 1
h2o =0
oc=0
c,h,o,n = et*2,6*et+2*h2o,h2o+et,0

Ae=(1.8*10**12) #etanol
Ea=15098
me=0.15
ne=1.6

cilindros=4
rotacao=2494
Var=85.07
Ru=8.314

N=rotacao*2*np.pi/60 #rad/s
M_c=(12.0107*c+h*1.008+16*o+28*n)

stoichometricH2O = h/2
stoichometricCO2 = c
OC = (2*stoichometricCO2 + stoichometricH2O - o)/2 #mols de oxigenio
stoichometricN2 = 3.76*OC+n

AC = OC*(32 + 3.76 * 28.16) / M_c  #razao ar combustivel
M_m=(M_c+OC*(32+3.76*28.16))/(1+OC+OC*3.76)  #massa molecular da mistura

#massa de ar admitida
m_air=Var/(0.5*3600*cilindros*(N/(2*np.pi))) #rot por s
#massa de mistura admitida
m_m=m_air/AC+m_air 
#massa de combustivel admitida
m_c=m_air/AC
mols_c = m_c/M_c
print(m_c)
##fracao massica inicial
Y0 = m_c/m_m
X0 = mols_c/(mols_c+mols_c*OC+3.76*OC*mols_c)

teta0d=-164
teta_combd=-10.2
delta_tetad=38.2
tetafd=146

teta0=radians(teta0d)
tetaf=radians(tetafd)
teta_comb=radians(teta_combd)
delta_teta=radians(delta_tetad)

tk=np.linspace(teta0,tetaf,1000)
ti=tk[:find_nearest(tk,teta_comb)]
tj=tk[find_nearest(tk,teta_comb):find_nearest(tk,teta_comb+delta_teta)]
tf=tk[find_nearest(tk,teta_comb+delta_teta):]

mass=[M_c,32,28,44,18,28]

def twoStepKinects (Concentrations0,ts,Temperature,Pressure):
    concentration = solve_ivp(dc,ts,Concentrations0,args=(Temperature,)).y
        
    C = concentration[0][-1]
    O2=concentration[1][-1]
    CO = concentration[2][-1]
    CO2=concentration[3][-1]
    H2O = concentration[4][-1]
    N2 = concentration[5][-1]
    next_concentration=[C,O2,CO,CO2,H2O,N2]
    
    molar_fractions = np.asarray(Concentrations0)*Ru*Temperature*10**6/Pressure

#    M_m=0
#    for M,ys in zip(mass,molar_fractions):
#        M_m += M*ys
#        
#    mass_fraction=molar_fractions[0]*(M_c/M_m)
#    mass_burned=(Y0-mass_fraction)/Y0
#    dx = (-dc(ts[-1],Concentrations0,Temperature)[0]*Ru*Temperature/Pressure)*(M_c/M_m)*10**6/Y0

    molar = np.asarray(next_concentration)*10**3*volume(ts[-1])

    mass_burned=(m_c-molar[0]*M_c)/m_c
    dx = -dc(ts[-1],next_concentration,Temperature)[0]*10**3*volume(ts[-1])*M_c/m_c
    
    return mass_burned,dx,next_concentration,molar_fractions*m_m/M_m

def dc (t,Concentrations,T):
    C=Concentrations[0]
    O2=Concentrations[1]
    CO=Concentrations[2]
    CO2=Concentrations[3]
    H2O=Concentrations[4]
    N2=Concentrations[5]
    
    ka=Ae*np.exp(-Ea/T)*np.sign(C)*abs(C)**me*O2**ne
#    kbf=10**14.6*np.exp(-20131/T)*CO*H2O**0.5*O2**0.25
#    kbr=5*10**8*np.exp(-20131/T)*CO2
    kbf=3.98*10**8*np.exp(-10/(1.987*10**-3)/T)*CO*H2O**0.5*O2**0.25
    kbr=6.16*10**13*T**-0.97*np.exp(-78.4/(1.987*10**-3)/T)*CO2*H2O**0.5*O2**-0.25
    
    dC=-ka/N
    dO2=(-(c/2+h/4)*ka-c*0.5*kbf+c*0.5*kbr)/N
    dCO=(-kbf+ka+kbr)*c/N
    dCO2=(kbf-kbr)*c/N
    dH2O=h/2*ka/N
    dN2=0
    #print(dC,dO2,dCO,dCO2,dH2O)
    return dC,dO2,dCO,dCO2,dH2O,dN2 #gmol;cm3




wiebeTemperature = [369.9822013476898, 370.15735695738806, 370.34016048812083, 370.53064101391, 370.72882951814375, 370.93475889983387, 371.14846398027925, 371.36998151013466, 371.59935017688167, 371.836610612695, 372.08180540270234, 372.3349790936357, 372.59617820286854, 372.86545122783434, 373.1428486558281, 373.42842297417957, 373.7222286808028, 374.0243222951113, 374.3347623693026, 374.6536095000018, 374.98092634026506, 375.3167776119427, 375.66123011838977, 376.0143527575327, 376.3762165352783, 376.7468945792705, 377.12646215298963, 377.5149966701877, 377.912577709668, 378.31928703039284, 378.7352085869317, 379.1604285452369, 379.5950352987503, 380.03911948484154, 380.4927740015725, 380.9560940247898, 381.4291770255438, 381.9121227878335, 382.4050334266758, 382.9080134065053, 383.4211695598938, 383.94461110660234, 384.47844967295634, 385.0227993115509, 385.57777652128044, 386.14350026771024, 386.72009200376334, 387.30767569075016, 387.9063778197329, 388.5163274332194, 389.1376561472007, 389.77049817352184, 390.4149903425963, 391.0712721264607, 391.7394856621755, 392.41977577555724, 393.11229000526856, 393.817178627243, 394.5345946794528, 395.2646939870153, 396.0076351876463, 396.7635797574405, 397.5326920369859, 398.3151392577999, 399.1110915690844, 399.92072206479446, 400.7442068109954, 401.5817248735137, 402.43345834584693, 403.2995923773357, 404.1803152015549, 405.0758181649188, 405.98629575544857, 406.91194563170296, 407.85296865180084, 408.80956890251724, 409.7819537283893, 410.77033376079567, 411.7749229469253, 412.79593857860164, 413.833601320853, 414.8881352401617, 415.95976783230583, 417.04873004966595, 418.1552563279172, 419.27958461194385, 420.4219563808537, 421.5826166719501, 422.7618141034639, 423.9598008958751, 425.1768328916288, 426.4131695729986, 427.66907407786135, 428.9448132131279, 430.24065746551054, 431.5568810093185, 432.89376171094267, 434.2515811296132, 435.6306245140601, 437.0311807945837, 438.4535425700541, 439.89800608931364, 441.36487122637027, 442.85444144879483, 444.36702377857944, 445.9029287447532, 447.4624703269131, 449.0459658887983, 450.65373610098766, 452.2861048516275, 453.9433991441092, 455.62594898048746, 457.3340872292825, 459.0681494763087, 460.82847385693714, 462.61540086814745, 464.42927315857924, 466.2704352946093, 468.13923350037766, 470.03601536947946, 471.9611295458531, 473.9149253712144, 475.8977524962161, 477.90996045216536, 479.9518981799807, 482.0239135128784, 484.12635260875595, 486.25955932821694, 488.42387455366236, 490.6196354446029, 492.84717462400494, 495.1068192899713, 497.3988902468241, 499.7237008490013, 502.0815558508441, 504.4727501547711, 506.8975674498998, 509.3562787323988, 511.84914069857115, 514.3763940006795, 516.9382613552119, 519.5349454923349, 522.1666269347648, 524.8334615933651, 527.5355781662581, 530.2730753272589, 533.0460186887927, 535.8544375237032, 538.6983212294684, 541.5776155177928, 544.4922183117689, 547.4419753321424, 550.426675353813, 553.4460451131455, 556.4997438464944, 559.5873574401768, 562.7083921723984, 565.8622680279577, 569.0483115673766, 572.2657483333103, 575.513694778723, 578.791149703749, 582.0969851908467, 585.4299370318457, 588.7885946451024, 592.1713904865953, 595.57658896587, 599.0022748859756, 602.446341436312, 605.9064777789164, 609.3801562819609, 612.8646194697089, 616.3568667756599, 619.8536412055529, 623.3514160390858, 626.8463817239012, 630.3344331423167, 633.8111574609787, 637.2718228045496, 640.71136802802, 644.1243938962103, 647.505156013774, 650.8475598830873, 654.1451584998373, 657.3911529250757, 660.578396296884, 663.6994017618624, 666.7463548145495, 669.7111305290106, 672.5853161486008, 675.3602394644394, 678.0270033584509, 680.5765268095884, 682.9995925618318, 685.2869015270107, 687.4291338461013, 689.417016358967, 692.3296079989154, 694.2505467339288, 695.7348528465192, 697.3356222553073, 699.6037812984349, 703.0851110002397, 708.3146567002461, 715.8087732595857, 726.0552597112963, 739.5022661514225, 756.5468463972059, 777.5241133984432, 802.6978808708677, 832.2534395952057, 866.2927722048373, 904.8321502463297, 947.8017820614183, 995.0470557852865, 1046.3309580802343, 1101.3374037910144, 1159.6754150458921, 1220.8842725189115, 1284.4398795579516, 1349.7626113095303, 1416.226868134058, 1483.1724324256477, 1549.9175644809586, 1615.7735920150387, 1680.0605735280274, 1742.1234686261962, 1801.3481445323837, 1857.1764976702002, 1909.1199766673067, 1956.7708568202117, 1999.8107292361, 2038.0158198014333, 2071.2589305214715, 2099.5079842658665, 2122.8213393248166, 2141.3402094470352, 2155.2786671372405, 2164.91181439375, 2170.5627701211165, 2172.5891446545766, 2171.3696499634143, 2167.2914331026354, 2160.738627134267, 2152.0824970332083, 2141.6734283852743, 2129.834874703887, 2116.859255010589, 2103.0056854406484, 2088.4993432742717, 2073.5322025161977, 2058.264847771317, 2042.8290660326725, 2027.3309304549025, 2011.854121249123, 1996.4632709064406, 1981.2071684849384, 1966.1217057493723, 1951.2324925911744, 1936.5571076199783, 1922.1069805703646, 1907.8889257447202, 1893.9063605259494, 1880.160251049336, 1866.6498297667358, 1853.3731283110192, 1840.327365148694, 1827.509222157357, 1814.9150384126142, 1802.5409437581006, 1790.382949579798, 1778.4370098184836, 1766.6990616922155, 1755.1650528277787, 1743.8309594175334, 1732.6927985085028, 1721.74663646588, 1710.9885949305472, 1700.4148551062958, 1690.0216609019344, 1679.8053212577015, 1669.7622118621523, 1659.8887763941636, 1650.1815273790037, 1640.6370467225786, 1631.251985970618, 1622.0230663311852, 1612.9470784912016, 1604.020882254683, 1595.2414060252813, 1586.6056461546414, 1578.1106661750027, 1569.753595932493, 1561.5316306363654, 1553.4420298370815, 1545.4821163455379, 1537.6492751038847, 1529.940952017436, 1522.354652756176, 1514.8879415334025, 1507.538439868054, 1500.3038253367902, 1493.1818303207904, 1486.1702407520147, 1479.2668948630399, 1472.4696819436076, 1465.7765411074138, 1459.1854600714357, 1452.6944739500843, 1446.3016640664823, 1440.0051567820892, 1433.8031223463443, 1427.6937737673684, 1421.6753657046627, 1415.7461933847524, 1409.9045915399665, 1404.1489333713857, 1398.477629535667, 1392.8891271563573, 1387.3819088595992, 1381.9544918343258, 1376.6054269168503, 1371.3332976996585, 1366.1367196642382, 1361.0143393377139, 1355.9648334729936, 1350.9869082519426, 1346.0792985114851, 1341.2407669919783, 1336.4701036074694, 1331.7661247376473, 1327.1276725406235, 1322.5536142865294, 1318.042841710902, 1313.5942703879425, 1309.2068391227572, 1304.8795093622794, 1300.6112646242289, 1296.401109943858, 1292.2480713376485, 1288.1511952838373, 1284.1095482190071, 1280.122216050421, 1276.1883036835627, 1272.3069345644283, 1268.4772502361538, 1264.6984099094475, 1260.9695900465315, 1257.2899839579886, 1253.6588014122392, 1250.0752682570885, 1246.5386260531563, 1243.0481317185604, 1239.603057184649, 1236.2026890623474, 1232.8463283187439, 1229.5332899635575, 1226.2629027452142, 1223.0345088561721, 1219.8474636470378, 1216.7011353494752, 1213.5949048072614, 1210.5281652154142, 1207.5003218670656, 1204.5107919077493, 1201.559004096935, 1198.6443985764809, 1195.7664266457427, 1192.9245505432295, 1190.1182432344215, 1187.3469882056381, 1184.6102792636868, 1181.9076203411382, 1179.238525306972, 1176.6025177824633, 1173.9991309621137, 1171.4279074393917, 1168.8883990372333, 1166.3801666430513, 1163.9027800480976, 1161.4558177911122, 1159.0388670060186, 1156.6515232736067, 1154.2933904770166, 1151.9640806609507, 1149.6632138944813, 1147.390418137295, 1145.1453291092942, 1142.927590163512, 1140.7368521621406, 1138.5727733556112, 1136.4350192646962, 1134.3232625654684, 1132.23718297705, 1130.1764671521075, 1128.1408085699743, 1126.1299074323886, 1124.1434705616516, 1122.181211301354, 1120.242849419331]
wiebePressure = [66780.0, 66895.388427203, 67016.45567634035, 67143.25315102839, 67275.8349659492, 67414.25799055932, 67558.58189517626, 67708.86919950088, 67865.18532363676, 68027.59864167059, 68196.18053788178, 68371.00546565349, 68552.15100916006, 68739.6979479106, 68933.73032423294, 69134.33551378507, 69341.60429918749, 69555.63094687251, 69776.51328725395, 70004.3527983225, 70239.25469278003, 70481.32800883103, 70730.68570475293, 70987.44475737664, 71251.726264611, 71523.65555215481, 71803.36228454439, 72090.9805806922, 72386.64913408151, 72690.5113377858, 73002.7154144943, 73323.41455172928, 73652.76704245263, 73990.93643126759, 74338.09166642991, 74694.40725789509, 75060.06344163704, 75435.24635048576, 75820.14819174251, 76214.96743184485, 76619.90898836326, 77035.18442962912, 77461.0121823035, 77897.61774721376, 78345.23392379867, 78804.10104352256, 79274.46721262782, 79756.5885646236, 80250.7295229198, 80757.16307403568, 81276.1710518372, 81808.04443327336, 82353.08364610876, 82911.59888917091, 83483.91046565685, 84070.34913006655, 84671.25644936567, 85286.98517899931, 85917.89965441523, 86564.37619878323, 87226.80354763527, 87905.58329117757, 88601.13033507044, 89313.87338050484, 90044.25542444746, 90792.73428096836, 91559.78312460502, 92345.89105677031, 93151.5636962521, 93977.32379491178, 94823.71187973343, 95691.28692243934, 96580.62703793708, 97492.3302129377, 98427.01506613188, 99385.32164139327, 100367.91223553692, 101375.47226224389, 102408.71115382806, 103468.36330261682, 104555.18904378299, 105669.97568156559, 106813.53856090551, 107986.72218660884, 109190.40139226415, 110425.48256122426, 111692.90490208322, 112993.64178118826, 114328.70211483024, 115699.13182388661, 117106.01535381081, 118550.4772629804, 120033.6838825539, 121556.84505112146, 123121.21592756058, 124728.0988856566, 126378.84549419204, 128074.85858633772, 129817.59442234889, 131608.56494969002, 133449.34016487398, 135341.5505814456, 137286.88980866963, 139287.11724564646, 141344.0608956794, 143459.62030587404, 145635.7696370433, 147874.56086910638, 150178.1271472674, 152548.68627429797, 154988.54435432632, 157500.0995935429, 160085.84626320077, 162748.37883027366, 165490.39626099326, 168314.70650235916, 171224.23114649608, 174222.0102824288, 177311.2075394897, 180495.11532608833, 183777.160266984, 187160.90884149118, 190650.07322419775, 194248.5173286923, 197960.26305359846, 201789.49672878662, 205740.57575782607, 209818.03545085058, 214026.59603960323, 218371.16986375194, 222856.86871446023, 227489.01131754264, 232273.13093448005, 237214.9830547361, 242320.55314745035, 247596.0644343619, 253047.98563881364, 258683.0386575804, 264508.20609333244, 270530.73857509345, 276758.16178261966, 283198.2830774132, 289859.1976284729, 296749.29390427895, 303877.25838414667, 311252.0793213103, 318883.0493671481, 326779.7668403768, 334952.13539659034, 343410.3618222606, 352164.9516427199, 361226.7021956807, 370606.6927804663, 380316.27144787664, 390367.03794677183, 400770.822290711, 411539.65835167444, 422685.75182792067, 434221.4418699851, 446159.1555830935, 458511.35455660877, 471290.4725027437, 484508.8430186038, 498178.61642012745, 512311.66453534056, 526919.4722905634, 542013.0148805218, 557602.6192855922, 573697.8088918913, 590307.1299887019, 607437.9589694135, 625096.2891551778, 643286.4963035161, 662011.0820675108, 681270.3949456721, 701062.3286199312, 721381.9980312331, 742221.3941016415, 763569.0186884283, 785409.5021609295, 807723.2069303305, 830485.8213402582, 853667.9495391921, 877234.7042949051, 901145.3111570616, 925352.7338975245, 949803.3327146256, 974436.5682198914, 999184.7656590666, 1023972.9550627753, 1048718.8039687932, 1073332.6598883532, 1097717.719672002, 1121770.3422362183, 1145380.519611161, 1168432.5188554474, 1190805.7039733357, 1214284.1689127842, 1235430.0052423489, 1255067.629080253, 1274075.4400126862, 1293379.580217049, 1313941.204621619, 1336737.1862799865, 1362734.6427377241, 1392860.2999947309, 1427966.4120197415, 1468795.5721874468, 1515947.1122120065, 1569847.745166992, 1630728.6357872158, 1698610.2740276782, 1773295.5985391233, 1854371.00712646, 1941214.3773242247, 2033009.052367474, 2128762.853989133, 2227331.4220889066, 2327445.4078231496, 2427741.1610530345, 2526794.5166003704, 2623157.1110247406, 2715394.401318983, 2802124.2719392707, 2882054.8685251637, 2954020.136031287, 3017011.49934582, 3070204.220388218, 3112977.192807801, 3144925.2730026455, 3165863.6612374135, 3175824.2991106235, 3175044.69804898, 3163950.0198834618, 3143129.564211517, 3113309.0569226993, 3075320.2689826963, 3030069.5230327738, 2978506.574731808, 2921595.1999338074, 2860286.5964482897, 2795496.441913414, 2728086.159913466, 2658848.656915588, 2588498.522651935, 2517666.4524227856, 2446897.463100394, 2376652.341985988, 2307311.6906606522, 2239181.9015171807, 2172502.4259601813, 2107453.7508813315, 2044165.5831536266, 1982724.8395616526, 1923183.1416919455, 1865563.61339562, 1809866.8661605334, 1756076.131037512, 1704161.5527562115, 1654083.7022847512, 1605796.3896955624, 1559248.872067781, 1514387.5540202772, 1471157.2741293118, 1429502.2615220498, 1389366.835523451, 1350695.909058148, 1313435.3447507732, 1277532.2020780684, 1242934.9048717564, 1209593.3510625383, 1177458.9807119302, 1146484.8139156573, 1116625.4668507562, 1087837.151840557, 1060077.6656131241, 1033306.3687427108, 1007484.1584489832, 982573.4363668171, 958538.072513703, 935343.3664121478, 912956.0061300764, 891344.0258606542, 870476.762552787, 850324.8120178898, 830859.9848671146, 812055.2625751205, 793884.7539158665, 776323.6519738561, 759348.1918965859, 742935.6095229526, 727064.1009945464, 711712.7834331418, 696861.6567476393, 682491.5666159507, 668584.1686728534, 655121.8939219493, 642087.9153793023, 629466.1159473838, 617241.0575104665, 605397.9512363749, 593922.6290645279, 582801.5163559659, 572021.6056779464, 561570.4316931054, 551436.0471210834, 541606.9997394397, 532072.3103893944, 522821.45195151685, 513844.3292563482, 505131.25989465846, 496672.95589255646, 488460.5062169465, 480485.3600774302, 472739.31099153106, 465214.4815806996, 457903.30906577216, 450798.531431069, 443893.1742276376, 437180.5379869384, 430654.18621737027, 424307.9339570221, 418135.8368570487, 412132.1807711009, 406291.47182724095, 400608.4269597504, 395077.96487914864, 389695.1974598066, 384455.4215252979, 379354.1110125925, 374386.9094971226, 369549.62306138914, 364838.213490812, 360248.79178101843, 355777.61194181355, 351421.0650835071, 347175.67377211974, 343038.0866405467, 339005.07324347825, 335073.51914431836, 331240.42122309864, 327502.8831947496, 323858.11132772715, 320303.4103534278, 316836.1795573069, 313453.909043076, 310154.1761617483, 306934.64209775795, 303793.0486046892, 300727.2148835971, 297735.0345971729, 294814.47301343124, 291963.5642727972, 289180.4087728753, 286463.17066540284, 283810.07546017464, 281219.4077309877, 278689.5089189068, 276218.77522836823, 273805.65561183094, 271448.64983899426, 269146.3066466514, 266897.2219655645, 264700.03722086234, 262553.4377026326, 260456.15100357422, 258406.94552068893, 256404.62901815274, 254448.04724867476, 252536.08263071944, 250667.65297915216, 248841.71028695008, 247057.23955575327, 245313.257673117, 243608.81233445214, 241942.98100771892, 240314.86993902468, 238723.61319739814, 237168.37175705223, 235648.33261554508, 234162.707946341, 232710.7342843054, 231291.6717427729, 229904.80326086472, 228549.4338798126, 227224.890047094, 225930.51894722995, 224665.68785816658, 223429.78353221543, 222222.21160054445, 221042.39600028412, 219889.77842335982, 218763.81778617649, 217663.98971933997, 216589.78607663853, 215540.71446252937, 214516.29777742972, 213516.0737801064, 212539.59466655523, 211586.42666469674]

wiebePressure1000 = [66780.0, 66825.40812986306, 66871.7173954028, 66918.93091804178, 66967.05188692396, 67016.08355932347, 67066.02926106291, 67116.89238694064, 67168.6764011678, 67221.3848378148, 67275.02130126719, 67329.58946669145, 67385.09308051063, 67441.53596088955, 67498.92199823029, 67557.25515567765, 67616.53946963472, 67676.77905028881, 67737.97808214792, 67800.14082458733, 67863.27161240712, 67927.37485640039, 67992.45504393212, 68058.51673952924, 68125.56458548152, 68193.60330245392, 68262.63769010999, 68332.67262774712, 68403.71307494285, 68475.76407221335, 68548.83074168362, 68622.91828776944, 68698.0319978719, 68774.17724308385, 68851.35947890898, 68929.58424599328, 69008.85717086945, 69089.18396671422, 69170.57043411833, 69253.02246187019, 69336.5460277527, 69421.14719935357, 69506.83213488947, 69593.60708404402, 69681.47838881986, 69770.45248440499, 69860.53590005361, 69951.7352599814, 70044.05728427564, 70137.50878982079, 70232.09669123875, 70327.8280018447, 70424.70983461873, 70522.7494031932, 70621.95402285625, 70722.33111157133, 70823.88819101364, 70926.63288762292, 71030.57293367355, 71135.71616836163, 71242.07053890954, 71349.64410168827, 71458.44502335772, 71568.48158202492, 71679.76216842132, 71792.29528709811, 71906.08955764082, 72021.15371590355, 72137.49661526218, 72255.1272278877, 72374.0546460397, 72494.28808338026, 72615.83687630856, 72738.71048531629, 72862.91849636496, 72988.47062228432, 73115.37670419323, 73243.64671294231, 73373.29075057982, 73504.31905184036, 73636.74198565671, 73770.5700566956, 73905.81390691746, 74042.48431716087, 74180.59220875123, 74320.14864513554, 74461.16483354173, 74603.65212666497, 74747.62202437957, 74893.0861754784, 75040.05637943881, 75188.54458821686, 75338.56290806942, 75490.12360140454, 75643.23908866117, 75797.9219502183, 75954.1849283338, 76112.04092911383, 76271.50302451328, 76432.5844543671, 76595.29862845418, 76759.65912859314, 76925.67971077107, 77093.3743073063, 77262.75702904443, 77433.84216758925, 77606.64419756904, 77781.17777893817, 77957.45775931509, 78135.49917635735, 78315.31726017418, 78496.92743577676, 78680.34532556777, 78865.58675187, 79052.66773949486, 79241.60451835216, 79432.4135261008, 79625.11141084168, 79819.71503385343, 80016.24147237153, 80214.70802241197, 80415.13220163953, 80617.5317522821, 80821.92464409125, 81028.32907735025, 81236.76348593038, 81447.2465403958, 81659.7971511588, 81874.43447168452, 82091.17790174866, 82310.04709074608, 82531.061941054, 82754.24261144851, 82979.60952057634, 83207.1833504827, 83436.98505019654, 83669.03583937357, 83903.3572119978, 84139.97094014437, 84378.89907780194, 84620.1639647584, 84863.78823054972, 85109.79479847245, 85358.20688966231, 85609.04802723913, 85862.34204052006, 86118.1130693011, 86376.38556820898, 86637.18431112489, 86900.53439568091, 87166.46124782966, 87434.9906264898, 87706.14862826865, 87979.96169226154, 88256.45660493187, 88535.66050507114, 88817.60088884116, 89102.30561490043, 89389.80290961546, 89680.12137235909, 89973.28998089585, 90269.3380968596, 90568.2954713196, 90870.19225044195, 91175.05898124503, 91482.92661745138, 91793.82652543747, 92107.79049028456, 92424.85072192956, 92745.03986142126, 93068.39098728115, 93394.9376219714, 93724.71373847373, 94057.75376697705, 94394.0926016805, 94733.76560771167, 95076.8086281613, 95423.25799123825, 95773.15051754682, 96126.5235274874, 96483.41484878284, 96843.86282413508, 97207.90631901144, 97575.5847295647, 97946.9379906887, 98322.00658421262, 98700.83154723547, 99083.45448060475, 99469.91755754038, 99860.26353240764, 100254.53574964078, 100652.77815282266, 101055.03529391908, 101461.3523426746, 101871.77509617015, 102286.3499885478, 102705.12410090269, 103128.14517134776, 103555.46160525398, 103987.1224856688, 104423.17758391457, 104863.67737037467, 105308.67302546522, 105758.21645080131, 106212.36028055547, 106671.15789301861, 107134.6634223603, 107602.93177059703, 108076.01861977046, 108553.98044433942, 109036.87452378974, 109524.75895546541, 110017.69266762718, 110515.73543273896, 111018.94788099162, 111527.39151406226, 112041.12871911828, 112560.22278306854, 113084.73790706576, 113614.73922126624, 114150.29279985113, 114691.46567631158, 115238.32585900748, 115790.94234699973, 116349.38514616534, 116913.725285596, 117484.03483428906, 118060.38691813523, 118642.85573720638, 119231.51658335202, 119826.44585810737, 120427.7210909202, 121035.4209577006, 121649.62529970346, 122270.41514274183, 122897.87271674674, 123532.08147567086, 124173.12611774876, 124821.09260611614, 125476.06818979584, 126138.14142505622, 126807.40219715032, 127483.94174244012, 128167.85267091396, 128859.22898910445, 129558.16612341188, 130264.7609438419, 130979.11178816481, 131701.31848650143, 132431.4823863455, 133169.70637802815, 133916.09492063266, 134670.75406836777, 135433.79149740568, 136205.31653319424, 136985.44017824772, 137774.2751404307, 138571.93586173528, 139378.53854756558, 140194.2011965338, 141019.04363078036, 141853.18752682014, 142696.75644693067, 143549.87587108454, 144412.6732294374, 145285.2779353812, 146167.82141916663, 147060.43716210919, 147963.26073138407, 148876.42981541777, 149800.08425989037, 150734.36610434964, 151679.4196194526, 152635.39134483863, 153602.43012764535, 154580.68716167664, 155570.31602722852, 156571.47273158567, 157584.31575019137, 158609.0060685058, 159645.70722455886, 160694.58535220398, 161755.80922508353, 162829.55030131375, 163915.98276889598, 165015.28359186457, 166127.63255717693, 167253.21232235339, 168392.20846387805, 169544.80952636054, 170711.2070724732, 171891.59573366548, 173086.1732616651, 174295.1405807673, 175518.70184092238, 176757.0644716256, 178010.43923661413, 179279.0402893719, 180563.0852294526, 181862.79515961962, 183178.39474380686, 184510.11226590406, 185858.17968936177, 187222.83271762775, 188604.31085540395, 190002.85747072846, 191418.7198578825, 192852.14930111176, 194303.4011391687, 195772.7348306668, 197260.41402023353, 198766.70660546632, 200291.88480467864, 201836.22522542358, 203400.0089337884, 204983.52152444093, 206587.05319142423, 208210.89879966772, 209855.3579572138, 211520.73508812557, 213207.33950606265, 214915.48548849547, 216645.49235153774, 218397.68452536094, 220172.39163015847, 221969.94855264094, 223790.69552299773, 225634.97819231352, 227503.1477103727, 229395.56080382285, 231312.57985463028, 233254.57297878832, 235221.91410520763, 237214.98305473672, 239234.16561923604, 241279.85364064254, 243352.4450899357, 245452.34414594233, 247579.96127387302, 249735.71330351225, 251920.02350695615, 254133.32167578864, 256376.04419759617, 258648.63413169424, 260951.54128393662, 263285.2222804825, 265650.14064037194, 268046.76684676635, 270475.57841668505, 272937.05996907665, 275431.70329105423, 277960.0074020865, 280522.4786159662, 283119.6306003269, 285751.98443351116, 288420.06865852734, 291124.41933386994, 293865.58008093963, 296644.10212777107, 299460.5443488194, 302315.4733004474, 305209.4632518529, 308143.096211048, 311116.96194557904, 314131.6579975819, 317187.7896928109, 320285.97014321614, 323426.820242638, 326610.96865518566, 329839.0517958058, 333111.71380256367, 336429.6065001066, 339793.389353765, 343203.72941374674, 346661.3012487977, 350166.7868687186, 353720.8756351004, 357324.26415957866, 360977.6561889157, 364681.7624761519, 368437.3006370711, 372244.9949911599, 376105.5763862295, 380019.7820058254, 383988.35515850317, 388012.04504804336, 392091.6065235843, 396227.79980869667, 400421.3902083059, 404673.14779233583, 408983.8470549864, 413354.26654840226, 417785.1884895332, 422277.3983389123, 426831.684349998, 431448.8370877774, 436129.6489151734, 440874.9134458329, 445685.42496178555, 450561.97779445344, 455505.36566739576, 460516.3809992016, 465595.8141648178, 470744.4527136371, 475963.0805425615, 481252.4770222692, 486613.4160748491, 492046.6652009199, 497552.984454366, 503133.1253627371, 508787.829791345, 514517.8287491128, 520323.8411341341, 526206.5724169695, 532166.7132596165, 538204.9380681498, 544321.9034770048, 550518.2467628868, 556794.584186287, 563151.509258671, 569589.5909333986, 576109.3717184485, 582711.3657091565, 589396.0565391813, 596163.8952480399, 603015.2980635968, 609950.6440980555, 616970.2729561018, 624074.4822539766, 631263.5250485034, 638537.6071751056, 645896.8844942737, 653341.4600460051, 660871.3811120066, 668486.6361858362, 676187.1518513213, 683972.7895699793, 691843.3423785697, 699798.5314981818, 707838.0028567832, 715961.3235275239, 724167.9780856413, 732457.3648872555, 740828.7922739744, 749281.4747076813, 757814.5288406888, 766426.9695269129, 775117.7057805149, 783885.536689183, 792729.1472899462, 801647.1044162418, 810637.8525258002, 819699.709519758, 828830.8625642563, 838029.3639268494, 847293.1268408368, 856619.9214116881, 866007.3705807298, 875452.9461622027, 884953.9649709284, 894507.5850586876, 904110.8020785582, 913760.4457974472, 923453.176777949, 933185.4832517845, 942953.6782078589, 952753.8967189636, 962582.0935319411, 972434.0409469341, 982305.3270119601, 992191.3540598023, 1002087.337614567, 1011988.3056956943, 1021889.0985475535, 1031784.3688227646, 1041668.5822473951, 1051536.0187960358, 1061380.774404248, 1071196.7632454447, 1080977.7205983326, 1090717.206330112, 1100408.609019373, 1110045.1507410896, 1119619.892534421, 1129125.7405719808, 1138555.4530469577, 1147901.6477919843, 1157156.8106407314, 1166313.304540211, 1175363.3794183745, 1184299.1828079775, 1193112.7712238396, 1201796.1222864776, 1210341.1475808602, 1218739.7062344383, 1227078.7879767807, 1235183.9969984635, 1243110.1003721072, 1250913.2225212755, 1258650.7776151418, 1266381.3756797519, 1274164.7019480304, 1282061.369159956, 1290132.7427721468, 1298440.7393406595, 1307047.598698926, 1316015.6309579704, 1325406.939800339, 1335283.124010338, 1345704.959667335, 1356732.0659087563, 1368422.5576258968, 1380832.6888687925, 1394016.491084801, 1408025.4105801417, 1422907.9497579436, 1438709.3167344031, 1455471.0878622958, 1473230.8874907875, 1492022.088971796, 1511873.540493139, 1532809.3187984717, 1554848.5132614833, 1578005.0421524837, 1602287.5022859662, 1627699.0526110926, 1654237.331717434, 1681894.4087084543, 1710656.7664564373, 1740505.3159119284, 1771415.4398983156, 1803357.0646799025, 1836294.7575426484, 1870187.8486546413, 1904990.5755700285, 1940652.2488813214, 1977117.4376971975, 2014326.1738078573, 2052214.1735777163, 2090713.0767721934, 2129750.7016574126, 2169251.3158107875, 2209135.92213907, 2249322.559610692, 2289726.6181869125, 2330261.167356346, 2370837.2975750053, 2411364.473774036, 2451750.8999291537, 2491903.893503094, 2531730.268372744, 2571136.724657757, 2610030.2436593655, 2648318.485936197, 2685910.1903625666, 2722715.5718634906, 2758646.7153875655, 2793617.9635828496, 2827546.2955679977, 2860351.6941607664, 2891957.498929894, 2922290.742476891, 2951282.4674304533, 2978868.0217541037, 3004987.330115972, 3029585.1392497015, 3052611.235449539, 3074020.632580808, 3093773.7292439938, 3111836.4340152256, 3128180.257971447, 3142782.374017264, 3155625.6428335235, 3166698.6055741953, 3175995.443745917, 3183515.906991619, 3189265.2097908496, 3193253.89834901, 3195497.689200652, 3196017.2812768933, 3194838.143387505, 3191990.2792504737, 3187507.9723449647, 3181429.5129907397, 3173796.9101463235, 3164655.590484402, 3154054.0873375162, 3142043.7221149155, 3128678.2807723708, 3114013.6878708676, 3098107.680691406, 3081019.4857808133, 3062809.500190538, 3043538.9795398912, 3023269.7348875105, 3002063.8402327173, 2979983.3522966737, 2957090.044049862, 2933445.1532642837, 2909109.147175253, 2884141.5041424604, 2858600.5130055435, 2832543.0906369463, 2806024.6180074112, 2779098.794898463, 2751817.513223574, 2724230.748756858, 2696386.4709166805, 2668330.5701123085, 2640106.8020361755, 2611756.748172392, 2583319.791695315, 2554833.107849499, 2526331.667835299, 2497848.255171907, 2469413.4934714637, 2441055.8845342183, 2412801.8556638444, 2384675.8151039705, 2356700.2145109028, 2328895.6174009293, 2301280.7725450387, 2273872.691325598, 2246686.728118562, 2219736.662820713, 2193034.784700579, 2166591.9768162896, 2140417.800309172, 2114520.577950064, 2088907.4763834516, 2063584.586581894, 2038557.0020904494, 2013828.8947047025, 1989403.5872879843, 1965283.6234925292, 1941470.834203826, 1917966.4005788357, 1894770.9135959977, 1871884.430077025, 1849306.5251790362, 1827036.3413892076, 1805072.6340835553, 1783413.8137362702, 1762057.984887696, 1741002.9819953747, 1720246.4023068412, 1699785.6359025287, 1679617.8930647196, 1659740.2291325827, 1640149.567005081, 1620842.717453898, 1601816.3974058595, 1583067.2463510553, 1564591.841027705, 1546386.7085290474, 1528448.3379704033, 1510773.1908475554, 1493357.7102095247, 1476198.328760774, 1459291.4759999819, 1442633.5844942143, 1426221.0953794091, 1410050.4631703962, 1394118.1599564042, 1378420.6790507657, 1362954.5381567853, 1347716.2821059164, 1332702.4852180146, 1317909.753328585, 1303334.7255226765, 1288974.0756107941, 1274824.5133778634, 1260882.785632972, 1247145.6770839053, 1233610.0110578325, 1220272.6500867482, 1207130.496373834, 1194180.4921551507, 1181419.619968871, 1168844.9028430798, 1156453.4044113916, 1144242.2289647218, 1132208.5214464178, 1120349.4673969909, 1108662.2928539782, 1097144.2642117625, 1085792.688045567, 1074604.9109034599, 1063578.3190695962, 1052710.3383017168, 1041998.4335455152, 1031440.1086282127, 1021032.9059335171, 1010774.4060598139, 1000662.227463406, 990694.0260883023, 980867.4949840836, 971180.3639131056, 961630.3989483109, 952215.4020626921, 942933.2107116197, 933781.697408722, 924758.7692965122, 915862.3677123368, 907090.4677506285, 898441.0778219735, 889912.2392098584, 881502.0256255802, 873208.5427619454, 865029.9278463308, 856964.3491935655, 849010.0057590978, 841165.1266929193, 833427.9708946006, 825796.8265698936, 818270.0107891388, 810845.869047884, 803522.7748299752, 796299.129173431, 789173.3602392677, 782143.9228836091, 775209.2982332346, 768367.9932647663, 761618.5403876841, 754959.4970313272, 748389.4452360199, 741906.9912484563, 735510.7651214692, 729199.4203182844, 722971.6333213536, 716826.1032458403, 710761.5514578146, 704776.7211972853, 698870.3772060603, 693041.3053604685, 687288.3123090382, 681610.2251150969, 676005.8909043683, 670474.176517535, 665013.9681678202, 659624.1711035214, 654303.7092755762, 649051.5250100839, 643866.5786858131, 638747.8484166611, 633694.3297390209, 628705.0353040815, 623778.994574983, 618915.2535288493, 614112.8743635812, 609370.9352094631, 604688.5298454944, 600064.7674203919, 595498.7721782696, 590989.6831888894, 586536.6540825018, 582138.8527891401, 577795.4612824298, 573505.6753277573, 569268.7042347962, 565083.7706143466, 560950.1101394186, 556866.9713104751, 552833.6152248376, 548849.3153501555, 544913.3573018996, 541025.0386248202, 537183.6685783035, 533388.5679256008, 529639.0687268213, 525934.5141356866, 522274.25819995266, 518657.6656654618, 515084.1117837486, 511552.9821231757, 508063.6723834969, 504615.5882138449, 501208.145034045, 497840.76785923034, 494512.89112767467, 491223.9585318217, 487973.4228524168, 484760.74579573324, 481585.3978338138, 478446.8580476664, 475344.6139733848, 472278.1614511461, 469247.00447700016, 466250.6550574394, 463288.6330666839, 460360.4661066222, 457465.6893693858, 454603.84550248936, 451774.48447648744, 448977.16345513077, 446211.4466679501, 443476.9052852005, 440773.11729520885, 438099.667383963, 435456.1468170132, 432842.15332354803, 430257.29098267027, 427701.1701118111, 425173.4071572258, 422673.6245865518, 420201.4507833865, 417756.5199438416, 415338.4719750481, 412946.952395548, 410581.61223757104, 408242.1079511358, 405928.1013099644, 403639.2593191338, 401375.2541244857, 399135.7629237189, 396920.4678791463, 394729.056032087, 392561.21921885933, 390416.6539883546, 388295.06152112945, 386196.14755002345, 384119.6222822608, 382065.20032299095, 380032.60060026665, 378021.54629141715, 376031.76475078415, 374062.9874388038, 372114.9498524168, 370187.3914567511, 368280.0556180918, 366392.6895380798, 364525.0441891295, 362676.8742510485, 360847.938048821, 359037.99749154295, 357246.8180124896, 355474.16851026774, 353719.8212910806, 351983.5520120262, 350265.13962545356, 348564.36632433766, 346881.0174886476, 345214.8816327121, 343565.7503535255, 341933.4182800238, 340317.683023263, 338718.34512752364, 337135.2080222888, 335568.0779751108, 334016.7640453241, 332481.0780385999, 330960.8344623243, 329455.8504817869, 327965.94587715826, 326490.9430012364, 325030.666737974, 323584.94446173, 322153.6059972703, 320736.48358047626, 319333.4118197655, 317944.2276581995, 316568.77033626987, 315206.8813553444, 313858.4044417735, 312523.1855116258, 311201.07263606513, 309891.91600732977, 308595.56790531287, 307311.88266475394, 306040.71664298495, 304781.92818826693, 303535.3776086736, 302300.9271415263, 301078.4409233656, 299867.7849604531, 298668.82709978573, 297481.4370006198, 296305.48610649444, 295140.8476177405, 293987.39646447095, 292845.00928003865, 291713.56437495904, 290592.9417112829, 289483.0228774135, 288383.6910633578, 287294.83103641163, 286216.32911725395, 285148.073156462, 284089.9525114266, 283041.8580236633, 282003.6819965118, 280975.31817322155, 279956.6617154062, 278947.6091818706, 277948.0585077934, 276957.9089842713, 275977.0612382009, 275005.41721250996, 274042.8801467239, 273089.35455785197, 272144.7462216046, 271208.96215392405, 270281.91059282725, 269363.5009805523, 268453.64394600387, 267552.25128749624, 266659.2359557829, 265774.51203736785, 264897.994738096, 264029.6003670214, 263169.2463205364, 262316.8510667688, 261472.3341302371, 260635.61607675816, 259806.61849860527, 258985.26399991242, 258171.4761823161, 257365.17963083266, 256566.29989997533, 255774.76350008982, 254990.49788391456, 254213.43143336894, 253443.4934465445, 252680.61412492066, 251924.7245607827, 251175.75672483837, 250433.64345405035, 249698.31843965076, 248969.71621535718, 248247.77214577838, 247532.422415006, 246823.60401539045, 246121.25473649814, 245425.3131542442, 244735.71862019994, 244052.41125107516, 243375.33191836064, 242704.42223814732, 242039.62456109602, 241380.88196257662, 240728.13823295606, 240081.33786804997, 239440.42605971333, 238805.348686596, 238176.05230502557, 237552.48414005377, 236934.59207662818, 236322.32465091278, 235715.63104174126, 235114.46106220543, 234518.76515137605, 233928.49436615105, 233343.60037323713, 232764.03544124996, 232189.75243294044, 231620.7047975469, 231056.84656325748, 230498.13232979737, 229944.5172611291, 229395.95707826488, 228852.40805219006, 228313.82699689956, 227780.17126254042, 227251.39872865862, 226727.467797554, 226208.3373877327, 225693.966927467, 225184.31634844784, 224679.3460795402, 224179.0170406308, 223683.2906365746, 223192.12875122883, 222705.4937415836, 222223.3484319786, 221745.65610841135, 221272.3805129316, 220803.4858381197, 220338.936721653, 219878.69824095213, 219422.73590790812, 218971.01566369753, 218523.50387366474, 218080.1673222929, 217640.97320824448, 217205.88913948444, 216774.88312846737, 216347.92358740792, 215924.97932361963, 215506.0195349206, 215091.01380511533, 214679.9320995424, 214272.74476068874, 213869.42250387315, 213469.936412993, 213074.25793633584, 212682.35888245853, 212294.2114161223, 211909.78805429622, 211529.06166221638, 211152.0054495078]
wiebeTemperature1000 =[369.9822013476898, 370.051242884436, 370.1215017558929, 370.1929797051172, 370.2656785235739, 370.3396000511929, 370.41474617642893, 370.4911188363211, 370.568720016556, 370.64755175153164, 370.7276161244228, 370.8089152672483, 370.89145136094055, 370.97522663541537, 371.0602433696448, 371.1465038917308, 371.2340105789805, 371.32276585798314, 371.41277220469004, 371.5040321444933, 371.5965482523085, 371.69032315265844, 371.7853595197576, 371.8816600775997, 371.9792276000449, 372.07806491091054, 372.17817488406166, 372.27956044350555, 372.3822245634842, 372.4861702685718, 372.59140063377237, 372.69791878461774, 372.8057278972693, 372.91483119862005, 373.0252319663983, 373.13693352927214, 373.2499392669573, 373.36425261032537, 373.4798770415124, 373.5968160940312, 373.7150733528839, 373.83465245467573, 373.95555708773117, 374.0777909922109, 374.2013579602305, 374.3262618359806, 374.45250651584865, 374.5800959485415, 374.7090341352092, 374.8393251295728, 374.9709730380502, 375.103982019885, 375.23835628727693, 375.3741001055137, 375.5112177931042, 375.64971372191155, 375.78959231729084, 375.93085805822477, 376.0735154774633, 376.21756916166345, 376.3630237515305, 376.50988394196094, 376.658154482187, 376.8078401759213, 376.95894588150526, 377.11147651205636, 377.2654370356173, 377.42083247530906, 377.5776679094816, 377.73594847186797, 377.8956793517399, 378.05686579406427, 378.2195130996608, 378.38362662536053, 378.54921178416794, 378.7162740454212, 378.88481893495697, 379.0548520352733, 379.22637898569644, 379.3994054825486, 379.57393727931577, 379.7499801868173, 379.92754007337794, 380.10662286500013, 380.2872345455373, 380.46938115687055, 380.65306879908326, 380.83830363064067, 381.02509186856776, 381.21343978863086, 381.40335372551834, 381.59484007302444, 381.78790528423445, 381.9825558717088, 382.17879840767137, 382.37663952419786, 382.5760859134053, 382.777144327643, 382.97982157968556, 383.1841245429259, 383.3900601515709, 383.5976354008376, 383.80685734715024, 384.01773310834096, 384.23026986384866, 384.44447485492105, 384.6603553848184, 384.87791881901745, 385.0971725854168, 385.31812417454427, 385.54078113976607, 385.7651510974952, 385.9912417274039, 386.21906077263543, 386.4486160400173, 386.67991540027754, 386.9129667882608, 387.1477782031463, 387.3843577086668, 387.62271343332935, 387.86285357063764, 388.1047863793147, 388.34852018352876, 388.5940633731179, 388.84142440381794, 389.09061179749216, 389.3416341423606, 389.5945000932331, 389.84921837173965, 390.1057977665678, 390.36424713369547, 390.62457539663086, 390.88679154665016, 391.1509046430365, 391.41692381332155, 391.6848582535291, 391.9547172284196, 392.22651007173357, 392.50024618644125, 392.7759350449883, 393.05358618954665, 393.33320923226694, 393.61481385552884, 393.898409812196, 394.1840069258704, 394.4716150911511, 394.76124427389027, 395.05290451145254, 395.3466059129764, 395.6423586596375, 395.94017300490987, 396.24005927483097, 396.5420278682699, 396.84608925719186, 397.15225398692957, 397.4605326764525, 397.7709360186366, 398.0834747805385, 398.39815980366916, 398.71500200427005, 399.0340123735855, 399.35520197814674, 399.6785819600439, 400.00416353720976, 400.33195800369975, 400.66197672997487, 400.99423116318314, 401.3287328274468, 401.66549332414377, 402.0045243321969, 402.34583760836034, 402.6894449875063, 403.0353583829188, 403.3835897865776, 403.7341512694515, 404.08705498179165, 404.4423131534211, 404.7999380940276, 405.15994219345953, 405.52233792201883, 405.88713783075286, 406.2543545517527, 406.6240007984471, 406.9960893658983, 407.370633131097, 407.74764505325936, 408.12713817412146, 408.50912561823725, 408.89362059327334, 409.2806363903049, 409.6701863841084, 410.06228403346154, 410.4569428814332, 410.8541765556795, 411.25399876873473, 411.65642331830696, 412.0614640875661, 412.4691350454341, 412.87945024687514, 413.29242383318456, 413.70807003226946, 414.12640315893833, 414.54743761517807, 414.97118789044026, 415.39766856191187, 415.8268942947983, 416.2588798425911, 416.6936400473394, 417.1311898399174, 417.571544240289, 418.01471835776766, 418.46072739127135, 418.90958662957854, 419.36131145157225, 419.8159173264905, 420.2734198141605, 420.7338345652354, 421.1971773214235, 421.66346391571005, 422.13271027257576, 422.60493240821063, 423.080146430713, 423.5583685402921, 424.0396150294557, 424.5239022831964, 425.0112467791623, 425.5016650878241, 425.99517387263387, 426.49178989016997, 426.9915299902773, 427.4944111161937, 428.000450304667, 428.50966468605793, 429.0220714844411, 429.53768801767626, 430.05653169748496, 430.57862002949867, 431.10397061330303, 431.6326011424625, 432.16452940453127, 432.6997732810454, 433.2383507475023, 433.7802798733196, 434.32557882177633, 434.8742658499368, 435.4263593085519, 435.9818776419408, 436.5408393878536, 437.10326317730744, 437.66916773440266, 438.2385718761121, 438.8114945120466, 439.38795464419496, 439.96797136663605, 440.5515638652233, 441.13875141723355, 441.72955339099815, 442.3239892454895, 442.92207852988224, 443.5238408830755, 444.12929603318594, 444.7384637969938, 445.3513640793618, 445.9680168726068, 446.5884422558316, 447.21266039421903, 447.8406915382727, 448.47255602301846, 449.1082742671576, 449.7478667721649, 450.3913541213464, 451.0387569788316, 451.6900960885203, 452.3453922729657, 453.00466643220045, 453.6679395425062, 454.33523265511303, 455.00656689484066, 455.6819634586606, 456.3614436141971, 457.04502869815434, 457.73274011466543, 458.42459933356446, 459.12062788857827, 459.82084737543255, 460.52527944987554, 461.23394582560917, 461.94686827212587, 462.66406861245787, 463.38556872081574, 464.1113905201333, 464.84155597950314, 465.5760871115073, 466.3150059694262, 467.0583346443354, 467.8060952620833, 468.5583099801434, 469.31500098433014, 470.07619048538953, 470.84190071544845, 471.61215392432103, 472.3869723756721, 473.1663783430156, 473.950394105572, 474.73904194395163, 475.5323441356726, 476.33032295051083, 477.1330006456585, 477.9403994607101, 478.75254161245726, 479.5694492894725, 480.39114464649936, 481.2176497986342, 482.0489868152836, 482.8851777139043, 483.72624445350135, 484.5722089279033, 485.42309295877084, 486.27891828836994, 487.13970657206755, 488.0054793705639, 488.87625814183957, 489.75206423282214, 490.63291887074837, 491.5188431542103, 492.4098580439115, 493.30598435306075, 494.20724273745896, 495.11365368521666, 496.0252375061289, 496.94201432066393, 497.86400404858426, 498.7912263971624, 499.7237008490025, 500.6614466494342, 501.604482793485, 502.5528280123898, 503.5065007596662, 504.4655191966996, 505.4299011778518, 506.3996642350679, 507.3748255619562, 508.35540199734777, 509.34141000830834, 510.3328656725758, 511.3297846604262, 512.3321822159357, 513.3400731376345, 514.3534717585142, 515.3723919253847, 516.3968469775754, 517.426849724923, 518.4624124250641, 519.5035467599766, 520.5502638117963, 521.6025740378312, 522.6604872447939, 523.7240125622197, 524.7931584150182, 525.8679324952003, 526.9483417326658, 528.034392265127, 529.1260894070517, 530.2234376176747, 531.3264404679927, 532.4351006067614, 533.5494197254427, 534.6693985220732, 535.7950366640493, 536.9263327497722, 538.0632842691457, 539.2058875628836, 540.354137780593, 541.5080288376415, 542.667553370726, 543.832702692136, 545.0034667426935, 546.1798340433116, 547.3617916451685, 548.5493250784335, 549.7424182995444, 550.9410536369828, 552.1452117355236, 553.3548714989297, 554.5700100310482, 555.7906025752962, 557.0166224524655, 558.248040996875, 559.4848274908, 560.7269490971203, 561.9743707902346, 563.2270552851356, 564.4849629646653, 565.7480518049151, 567.0162772986979, 568.2895923771501, 569.5679473293623, 570.8512897200563, 572.139564305273, 573.4327129460657, 574.7306745201489, 576.0333848315394, 577.3407765181166, 578.652778957144, 579.9693181687069, 581.2903167170819, 582.6156936100352, 583.9453641960363, 585.2792400594207, 586.6172289134939, 587.9592344915818, 589.3051564360804, 590.6548901854947, 592.0083268595333, 593.3653531422592, 594.7258511633671, 596.0896983776331, 597.4567674425914, 598.8269260944878, 600.2000370226135, 601.5759577421021, 602.9545404652439, 604.3356319714576, 605.7190734760102, 607.1047004976383, 608.4923427251646, 609.8818238832847, 611.2729615976841, 612.6655672596297, 614.0594458902906, 615.4543960048868, 616.8502094769848, 618.2466714031264, 619.6435599680141, 621.040646310584, 622.4376943912071, 623.8344608603121, 625.2306949288035, 626.6261382405613, 628.0205247474188, 629.4135805869724, 630.8050239636653, 632.1945650335268, 633.5819057930618, 634.9667399726889, 636.3487529353025, 637.7276215804077, 639.1030142543872, 640.4745906674677, 641.8420018179494, 643.2048899243093, 644.562888365812, 645.9156216322697, 647.2627052835884, 648.6037459198476, 649.9383411625676, 651.2660796479087, 652.5865410325422, 653.8992960129319, 655.2039063588359, 656.4999249617465, 657.7868958990945, 659.0643545150184, 660.3318275184465, 661.5888330993547, 662.8348810639352, 664.0694729894931, 665.2921023998413, 666.502254961961, 667.6994087046344, 668.8830342598346, 670.0525951275087, 671.2075479644053, 672.3473428976115, 673.4714238633283, 674.579228971404, 675.6701908961265, 676.7437372936166, 677.7992912462056, 678.8362717340138, 679.8540941339056, 680.8521707459189, 681.8299113471274, 682.78672377284, 683.7220145249029, 684.6351894067521, 685.5256541847838, 686.3928152754258, 687.2360804572113, 688.0548596070024, 688.8485654593775, 689.6166143880482, 690.3584272080201, 691.0734299971045, 691.7610549351974, 692.474447531986, 693.1188875796388, 693.7296604036615, 694.3420155838322, 694.9911615079508, 695.7122487284921, 696.5403422211467, 697.510382685967, 698.657137099108, 700.0151388144252, 701.6186176274891, 703.501420346639, 705.6969225627902, 708.2379324663684, 711.1565877200782, 714.4842465529678, 718.251374386603, 722.4874274302051, 727.220734779875, 732.478380620386, 738.2860881506364, 744.668106829893, 751.6471044714034, 759.2440655904502, 767.4781972513293, 776.3668434558583, 785.9254088851796, 796.1672925547161, 807.1038316854557, 818.7442558393603, 831.0956511319138, 844.162934124919, 857.9488348314961, 872.4538881358835, 887.6764328495257, 903.6126175901949, 920.2564126822272, 937.5996273289337, 955.6319313944119, 974.3408812471987, 993.7119492505924, 1013.7285566277707, 1034.372109575521, 1055.622038639056, 1077.4558414909106, 1099.8491293674929, 1122.7756775087976, 1146.207480016326, 1170.114809587155, 1194.4662826061524, 1219.2289300699547, 1244.3682747929233, 1269.848415298139, 1295.6321167294477, 1321.6809090396741, 1347.9551926130537, 1374.414351377223, 1401.0168733412559, 1427.7204783813931, 1454.4822529711737, 1481.2587914329083, 1508.0063431663589, 1534.6809651983988, 1561.2386792870645, 1587.6356327160236, 1613.8282618271935, 1639.773457262484, 1665.428729821081, 1690.752375791232, 1715.7036405803924, 1740.2428794472985, 1764.3317141371822, 1787.9331842331512, 1811.0118920616383, 1833.5341400346442, 1855.4680593626874, 1876.783729144524, 1897.4532849177428, 1917.45101584474, 1936.7534498116268, 1955.3394258210405, 1973.1901531794324, 1990.2892570943552, 2006.622810422874, 2022.1793514357767, 2036.9498875857732, 2050.9278853949018, 2064.109246693343, 2076.4922715626044, 2088.077608445772, 2098.8681919946107, 2108.8691693211185, 2118.08781541126, 2126.5334385396964, 2134.217276594847, 2141.1523852845135, 2147.3535192415216, 2152.8370070867727, 2157.6206215340576, 2161.723445635804, 2165.165736271931, 2167.9687859768587, 2170.154784180067, 2171.7466789066316, 2172.768039944542, 2173.2429244369723, 2173.195745800786, 2172.6511468078033, 2171.633877594331, 2170.168679287838, 2168.2801738586577, 2165.992760720331, 2163.3305205158667, 2160.3171264397124, 2156.975763358196, 2153.3290549049702, 2149.398998644378, 2145.2069093149244, 2140.773370088608, 2136.1181917101603, 2131.2603793139256, 2126.218106656207, 2121.008697447087, 2115.648613419067, 2110.1534487303966, 2104.537930267869, 2098.8159233890497, 2093.0004426252444, 2087.1036668547404, 2081.136958451328, 2075.1108859132796, 2069.0352494854505, 2062.919109298257, 2056.7708155640607, 2050.5980403918406, 2044.4078108043582, 2038.206542569313, 2032.0000744842057, 2025.7937027850614, 2019.5922153810482, 2013.3999256484456, 2007.2207055496117, 2001.0580178744883, 1994.9149474324386, 1988.7942310521798, 1982.6982862756151, 1976.629238657952, 1970.5889476107054, 1964.579030747418, 1958.6008867115222, 1952.6557164847165, 1946.7445431898313, 1940.8682304165256, 1935.0274991097015, 1929.222943070186, 1923.4550431258106, 1917.7241800365218, 1912.0306462021683, 1906.374656244407, 1900.7563565361709, 1895.175833752368, 1889.6331225154802, 1884.1282122081084, 1878.6610530225066, 1873.2315613148085, 1867.8396243282805, 1862.485104346605, 1857.1678423345097, 1851.887661119431, 1846.644368163815, 1841.4377579736108, 1836.2676141852403, 1831.1337113688842, 1826.0358165829477, 1820.9736907107747, 1815.9470896077003, 1810.955765083165, 1805.9994657403822, 1801.0779376928751, 1796.1909251752702, 1791.338171063468, 1786.5194173171785, 1781.734405356528, 1776.9828763823605, 1772.2645716490392, 1767.579232696762, 1762.92660154981, 1758.306420886059, 1753.7184341821853, 1749.1623858384373, 1744.6380212861739, 1740.145087080802, 1735.6833309825302, 1731.252502026662, 1726.8523505851047, 1722.4826284203884, 1718.143088733219, 1713.8334862045774, 1709.5535770329914, 1705.3031189677154, 1701.081871338212, 1696.8895950804938, 1692.7260527605524, 1688.59100859529, 1684.4842284710423, 1680.4054799602031, 1676.3545323356668, 1672.3311565837607, 1668.3351254153445, 1664.3662132755835, 1660.4241963521201, 1656.508852582074, 1652.6199616577262, 1648.757305031027, 1644.9206659170543, 1641.1098292964161, 1637.3245819166427, 1633.5647122926807, 1629.8300107064665, 1626.1202692057589, 1622.4352816020826, 1618.7748434679813, 1615.1387521335455, 1611.5268066823369, 1607.9388079465753, 1604.3745585018119, 1600.8338626610257, 1597.3165264681768, 1593.8223576912621, 1590.3511658149148, 1586.9027620325526, 1583.4769592380956, 1580.0735720173147, 1576.692416638819, 1573.333311044692, 1569.9960748408087, 1566.6805292868023, 1563.3864972858444, 1560.1138033741424, 1556.8622737101373, 1553.631736063546, 1550.4220198041442, 1547.2329558904094, 1544.0643768579528, 1540.9161168078535, 1537.7880113947394, 1534.6798978148554, 1531.5916147939213, 1528.5230025749472, 1525.473902905945, 1522.4441590275017, 1519.433615660358, 1516.4421189928564, 1513.4695166684307, 1510.5156577729274, 1507.5803928219923, 1504.6635737484078, 1501.7650538893733, 1498.8846879738348, 1496.0223321097496, 1493.1778437714365, 1490.3510817868128, 1487.5419063247937, 1484.7501788826141, 1481.975762273177, 1479.2185206124911, 1476.4783193071437, 1473.7550250417373, 1471.048505766454, 1468.3586306846391, 1465.6852702404378, 1463.0282961065027, 1460.3875811717319, 1457.7629995291331, 1455.154426463681, 1452.5617384402985, 1449.984813091895, 1447.4235292074875, 1444.8777667203726, 1442.3474066964286, 1439.8323313224325, 1437.3324238945236, 1434.847568806715, 1432.377651539529, 1429.9225586486755, 1427.482177753869, 1425.0563975276784, 1422.6451076845194, 1420.2481989697428, 1417.8655631487684, 1415.4970929963451, 1413.1426822859387, 1410.8022257791538, 1408.4756192152909, 1406.1627593010069, 1403.8635437000362, 1401.5778710230525, 1399.3056408176108, 1397.0467535581633, 1394.801110636227, 1392.5686143506396, 1390.3491678978191, 1388.142675362299, 1385.9490417071818, 1383.768172764842, 1381.599975227604, 1379.4443566385885, 1377.301225382663, 1375.170490677448, 1373.0520625644417, 1370.945851900242, 1368.8517703478617, 1366.7697303681673, 1364.6996452113517, 1362.6414289085544, 1360.5949962635507, 1358.560262844577, 1356.537144976167, 1354.5255597311693, 1352.5254249228115, 1350.536659096852, 1348.5591815238374, 1346.5929121914392, 1344.6377717969244, 1342.6936817396372, 1340.7605641136179, 1338.838341700325, 1336.9269379613868, 1335.026277031492, 1333.1362837113559, 1331.2568834607443, 1329.3880023915915, 1327.5295672612422, 1325.6815054656977, 1323.8437450330275, 1322.016214616806, 1320.1988434896352, 1318.3915615367703, 1316.594299249803, 1314.8069877204243, 1313.029558634294, 1311.2619442649113, 1309.5040774676693, 1307.7558916738783, 1306.0173208849294, 1304.2882996665123, 1302.568763142884, 1300.8586469912627, 1299.1578874362083, 1297.466421244174, 1295.784185718031, 1294.1111186917376, 1292.4471585250092, 1290.7922440981133, 1289.1463148066944, 1287.5093105566727, 1285.8811717592043, 1284.2618393257214, 1282.6512546630204, 1281.0493596683855, 1279.456096724846, 1277.8714086964112, 1276.2952389234222, 1274.7275312179288, 1273.168229859154, 1271.6172795889966, 1270.074625607598, 1268.5402135689462, 1267.0139895765656, 1265.4959001792236, 1263.9858923667475, 1262.4839135658435, 1260.9899116359618, 1259.5038348652847, 1258.0256319666682, 1256.5552520737172, 1255.0926447368627, 1253.6377599195027, 1252.1905479941902, 1250.7509597388766, 1249.3189463331873, 1247.8944593547506, 1246.4774507755806, 1245.0678729584913, 1243.665678653569, 1242.2708209946716, 1240.8832534959909, 1239.5029300486467, 1238.1298049173242, 1236.763832736945, 1235.4049685094108, 1234.0531676003368, 1232.708385735871, 1231.3705789995333, 1230.039703829092, 1228.7157170134778, 1227.3985756897482, 1226.0882373400736, 1224.7846597887738, 1223.4878011993728, 1222.1976200717186, 1220.914075239099, 1219.6371258654217, 1218.3667314424379, 1217.1028517869556, 1215.8454470381246, 1214.5944776547399, 1213.3499044125856, 1212.1116884017983, 1210.8797910242658, 1209.654173991067, 1208.434799319937, 1207.2216293327524, 1206.0146266530512, 1204.8137542035997, 1203.61897520396, 1202.4302531681024, 1201.2475519020466, 1200.0708355015227, 1198.9000683496622, 1197.735215114725, 1196.5762407478376, 1195.4231104807554, 1194.2757898236864, 1193.134244563099, 1191.9984407595555, 1190.8683447456142, 1189.7439231236922, 1188.6251427640125, 1187.5119708025468, 1186.4043746389557, 1185.3023219346187, 1184.2057806106188, 1183.114718845784, 1182.0291050747473, 1180.9489079860243, 1179.8740965201139, 1178.8046398676224, 1177.7405074674014, 1176.6816690047071, 1175.6280944093976, 1174.5797538541124, 1173.5366177525223, 1172.498656757545, 1171.4658417596263, 1170.4381438849998, 1169.415534494011, 1168.397985179401, 1167.3854677646834, 1166.3779543024464, 1165.3754170727696, 1164.377828581579, 1163.385161559066, 1162.3973889581075, 1161.4144839527007, 1160.436419936422, 1159.4631705208867, 1158.4947095342543, 1157.5310110197147, 1156.5720492340056, 1155.6177986459638, 1154.668233935052, 1153.723329989934, 1152.7830619070548, 1151.8474049892302, 1150.9163347442454, 1149.989826883487, 1149.0678573205794, 1148.150402170026, 1147.2374377458823, 1146.328940560419, 1145.424887322828, 1144.5252549379102, 1143.6300205048015, 1142.7391613156938, 1141.8526548545885, 1140.9704787960375, 1140.0926110039186, 1139.2190295302069, 1138.349712613771, 1137.484638679178, 1136.6237863354982, 1135.7671343751433, 1134.9146617726976, 1134.066347683758, 1133.2221714438222, 1132.3821125671263, 1131.5461507455523, 1130.7142658475036, 1129.8864379168342, 1129.0626471717314, 1128.2428740036623, 1127.4270989763124, 1126.615302824514, 1125.8074664532144, 1125.0035709364447, 1124.2035975162873, 1123.407527601871, 1122.61534276836, 1121.8270247559578, 1121.0425554689357, 1120.2619169746397, 1119.4850915025406, 1118.7120614432654, 1117.9428093476542]

Pi=wiebePressure1000[len(ti)]
Ti=wiebeTemperature1000[len(ti)]

#para 23% etanol->mudar para octano puro
Qa=[0.0, 0.0034457118506678367, 0.006814510371268267, 0.010103064544478842, 0.013308025123274414, 0.016426023529543574, 0.019453670741383725, 0.022387556168402774, 0.025224246514327822, 0.02796028462622212, 0.030592188329584477, 0.03311644924859296, 0.035529531610731274, 0.037827871035026, 0.04000787330309064, 0.042065913112161915, 0.04399833280928073, 0.045801441105755236, 0.04747151177100753, 0.0490047823048911, 0.05039745258752292, 0.051645683505659935, 0.0527455955545999, 0.053693267414570055, 0.05448473450052628, 0.05511598748423532, 0.055582970787500616, 0.0558815810453229, 0.05600766553776368, 0.05595702058922507, 0.055725389933814824, 0.0553084630454109, 0.054701873430997416, 0.0539011968857756, 0.05290194970850406, 0.051699586875461445, 0.05028950017135227, 0.04866701627542364, 0.046827394800972616, 0.044765826286365495, 0.04247743013560394, 0.03995725250639088, 0.037200264143566454, 0.03420135815569361, 0.030955347732479377, 0.027456963800611835, 0.02370085261550037, 0.019681573286287543, 0.015393595231389837, 0.010831295561708823, 0.005988956388521386, 0.0008607620529254914, -0.004559203726410233, -0.010276960790606304, -0.016298635566590683, -0.02263046418549666, -0.029278795697329708, -0.036250095385946604, -0.04355094818861201, -0.051188062224556234, -0.05916827243717658, -0.0674985443547356, -0.0761859779746344, -0.08523781177655455, -0.09466142687003773, -0.10446435128229388, -0.11465426439232507, -0.12523900151771403, -0.13622655866072814, -0.14762509742069904, -0.159442950079962, -0.1716886248709571, -0.18437081143248923, -0.19749838646346551, -0.21108041958286008, -0.22512617940503013, -0.23964513983994493, -0.25464698662834084, -0.2701416241222581, -0.28613918232193225, -0.30265002418048326, -0.3196847531884214, -0.3372542212504897, -0.3553695368679995, -0.37404207364037617, -0.3932834791002938, -0.41310568389740515, -0.4335209113464089, -0.45454168735586226, -0.4761808507549112, -0.49845156403592455, -0.5213673245317636, -0.544941976047317, -0.5691897209657563, -0.5941251328509319, -0.6197631695682154, -0.6461191869471029, -0.6732089530098813, -0.7010486627917457, -0.7296549537787568, -0.7590449219912299, -0.7892361387411879, -0.820246668093762, -0.8520950850635842, -0.8848004945784361, -0.918382551243657, -0.9528614799421397, -0.9882580973059053, -1.0245938340966327, -1.061890758533776, -1.1001716006101268, -1.1394597774360313, -1.1797794196546203, -1.2211553989716295, -1.26361335684457, -1.3071797343769682, -1.3518818034644564, -1.397747699240282, -1.444806453868528, -1.49308803173387, -1.5426233660769908, -1.5934443971248426, -1.6455841117647438, -1.6990765848106426, -1.753957021908984, -1.8102618041300258, -1.8680285342885414, -1.927296085035107, -1.9881046487557796, -2.050495789313756, -2.114512495661259, -2.180199237343794, -2.2476020219109856, -2.3167684542394467, -2.38774779776224, -2.460591037586969, -2.5353509454699297, -2.612082146596554, -2.6908411880987697, -2.7716866092169656, -2.8546790129881834, -2.939881139312061, -3.0273579392118317, -3.1171766500685476, -3.2094068715623947, -3.3041206420046083, -3.4013925146866177, -3.501299633808985, -3.6039218094804744, -3.709341591196575, -3.817644339116327, -3.928918292354765, -4.043254633395962, -4.1607475476061415, -4.281494276687969, -4.405595164764139, -4.533153695610154, -4.664276519371902, -4.799073466902614, -4.937657549635085, -5.08014494266911, -5.226654948500004, -5.377309938543079, -5.532235269321445, -5.6915591698822485, -5.855412596691945, -6.023929051937759, -6.197244360834602, -6.375496403210543, -6.558824794327261, -6.7473705095937015, -6.941275447564132, -7.140681925389398, -7.345732100729518, -7.556567314057168, -7.773327345307502, -7.996149578986492, -8.225168072167218, -8.460512520312642, -8.702307116600213, -8.950669301423314, -9.2057084000446, -9.467524148012988, -9.73620510596212, -10.011826967810883, -10.294450769206543, -10.584121006294378, -10.880863678555478, -11.184684273498515, -11.49556571536676, -11.813466304645095, -12.138317679908615, -12.47002283829197, -12.808454255390059, -13.153452149504826, -13.504822938575666, -13.862337940599812, -13.89272632908283, -14.180443406257197, -14.55188363226761, -14.834273239269008, -14.855718126095532, -14.445681680012541, -13.435889566833938, -11.661653886659403, -8.963601335850832, -5.189779249998477, -0.1980998865357808, 6.140932499913063, 13.941284641650892, 23.29833823666408, 34.28582348267826, 46.95286658219368, 61.321288277249074, 77.38329840237597, 95.09973319598753, 114.39897638581759, 135.17669088309663, 157.29646477927957, 180.59144335000963, 204.8669787593401, 229.90428270409717, 255.46501665105345, 281.29670252614085, 307.1387870828112, 332.7291492673287, 357.81080517668426, 382.138542728437, 405.485210287246, 427.6473916204799, 448.45022394699464, 467.7511555308929, 485.44249207044146, 501.45264376146554, 515.7460532267805, 528.3218538015961, 539.2113730879984, 548.4746536323761, 556.1962070967727, 562.4802474740286, 567.4456611173568, 571.2209664341924, 573.9394952798366, 575.7349939045395, 576.737797276669, 577.0716808524552, 576.851442693702, 576.1812202994892, 575.1535040382573, 573.8487751583571, 572.3356724737552, 570.6715783418852, 568.9035108682288, 567.0692140018905, 565.1983484207163, 563.3137016923622, 561.4323540055634, 559.5667538912269, 557.725675272164, 555.9150418237078, 554.1386163874162, 552.398561864144, 550.6958857607508, 549.0307837479809, 547.4028987074985, 545.8115113473153, 544.2556770638465, 542.7343217705101, 541.2463072468756, 539.790474438564, 538.3656712142276, 536.9707694439649, 535.6046749286177, 534.2663326686095, 532.9547291792825, 531.66889299239, 530.407894084683, 529.1708427027012, 527.9568878728993, 526.7652157703719, 525.59504804689, 524.4456401747292, 523.3162798365138, 522.2062853761248, 521.1150043171754, 520.0418119508862, 518.9861099927148, 517.9473253058339, 516.9249086889478, 515.9183337256821, 514.9270956927093, 513.9507105237835, 512.9887138269324, 512.0406599521324, 511.1061211068979, 510.18468651731996, 509.27596163219175, 508.37956736796934, 507.4951393924173, 506.6223274448937, 505.76079469132907, 504.9102171120494, 504.07028292068907, 503.2406920125302, 502.4211554406897, 501.6113949186609, 500.81114234779574, 500.0201393683881, 499.2381369330931, 498.4648949014858, 497.700181654627, 496.9437737285662, 496.19545546577393, 495.4550186835457, 494.7222623584779, 493.9969923261632, 493.2790209953015, 492.5681670754661, 491.86425531780753, 491.1671162680189, 490.4765860309203, 489.7925060460594, 489.114722873757, 488.4430879910578, 487.77745759707614, 487.1176924272567, 486.46365757609345, 485.81522232787745, 485.17225999506746, 484.53464776389814, 483.90226654686245, 483.2750008417257, 482.65273859674465, 482.03537108178466, 481.4227927650449, 480.8149011951147, 480.21159688810104, 479.6127832195806, 479.01836632114237, 478.4282549812992, 477.8423605505594, 477.260596850459, 476.68288008636597, 476.10912876387937, 475.53926360865273, 474.9732074894817, 474.41088534450387, 473.8522241103659, 473.29715265422124, 472.74560170842824, 472.19750380782483, 471.6527932294629, 471.11140593469037, 470.57327951347634, 470.0383531308767, 469.50656747554655, 468.9778647102075, 468.45218842398384, 467.92948358652484, 467.40969650383585, 466.89277477574296, 466.37866725492097, 465.867324007417, 465.35869627460556, 464.8527364365142, 464.34939797646115, 463.8486354469497, 463.3504044367662, 462.85466153923204, 462.3613643215604, 461.8704712952727, 461.38194188763094, 460.89573641404417, 460.411816051409, 459.93014281234684, 459.4506795203007, 458.9733897854576, 458.4982379814632, 458.0251892228973, 457.5542093434793, 457.0852648749756, 456.618323026781, 456.15335166614716, 455.69031929903366, 455.2291950515571, 454.7699486520151, 454.3125504134629, 453.85697121682153, 453.40318249449786, 452.9511562144951, 452.5008648649978, 452.0522814394114, 451.60537942183936, 451.16013277298316, 450.7165159164471, 450.2745037254343, 449.83407150981856, 449.395195003579, 448.9578503525826, 448.5220141027038]
Qp=[0.0, -0.002052376350497149, -0.004058940657936137, -0.006017708861701528, -0.00792668604298281, -0.009783865768755184, -0.011587229429017366, -0.01333474556688444, -0.015024369201121756, -0.016654041140701372, -0.018221687290950483, -0.01972521795084972, -0.021162527101031413, -0.02253149168201439, -0.02382997086219852, -0.02505580529513302, -0.026206816365554653, -0.027280805423679666, -0.028275553007218377, -0.02918881805056388, -0.030018337080589607, -0.03076182339847396, -0.03141696624694887, -0.03198142996235156, -0.03245285311083629, -0.032828847608081975, -0.03310699782180712, -0.03328485965638017, -0.03335995961878682, -0.03332979386519005, -0.03319182722728846, -0.0329434922176502, -0.03258218801316838, -0.0321052794157496, -0.03151009578931392, -0.030793929972147475, -0.02995403716361134, -0.028987633784170005, -0.027891896307660397, -0.026663960064678086, -0.025300918015912187, -0.023799819494210134, -0.02215766891410273, -0.020371424447467635, -0.018437996663951517, -0.016354247134712167, -0.01411698699798139, -0.011722975484882924, -0.009168918403871594, -0.006451466582089746, -0.0035672142618591507, -0.0005126974504520874, 0.0027156077788014887, 0.006121287036098858, 0.009707989417558446, 0.013479429362638563, 0.017439388568892468, 0.02159171796648001, 0.025940339754963807, 0.030489249505029785, 0.03524251832790063, 0.040204295115328526, 0.045378808853190004, 0.05077037101184555, 0.05638337801656767, 0.062222313801498744, 0.06829175245075628, 0.0745963609304716, 0.08114090191572132, 0.08793023671649859, 0.09496932830705869, 0.10226324446317764, 0.10981716101207124, 0.11763636519994594, 0.1257262591823781, 0.13409236364296898, 0.14274032154596247, 0.15167590202879233, 0.1609050044407881, 0.170433662534571, 0.1802680488169643, 0.19041447906656322, 0.20087941702543907, 0.2116694792727973, 0.2227914402887731, 0.2342522377169171, 0.2460589778343238, 0.2582189412387619, 0.270739588762593, 0.28362856762370803, 0.29689371782417917, 0.31054307880780346, 0.32458489638821203, 0.3390276299597503, 0.3538799600038655, 0.36915079590429967, 0.3848492840849735, 0.40098481648504014, 0.41756703938621603, 0.43460586260812917, 0.4521114690880932, 0.4700943248623899, 0.48856518946683586, 0.5075351267751359, 0.5270155162942389, 0.54701806493666, 0.5675548192904881, 0.5886381784085467, 0.6102809071389595, 0.6324961500201156, 0.6552974457638047, 0.6786987423510416, 0.7027144127658193, 0.7273592713927607, 0.7526485911053001, 0.7785981210716528, 0.8052241053064243, 0.832543301996194, 0.8605730036278423, 0.8893310579486944, 0.9188358897877462, 0.9491065237672743, 0.9801626079339912, 1.0120244383385648, 1.044712984591714, 1.0782499164242336, 1.1126576312770888, 1.1479592829461218, 1.1841788113039047, 1.2213409731187133, 1.2594713739875112, 1.298596501396036, 1.3387437589145486, 1.3799415015324286, 1.4222190721284003, 1.4656068390656987, 1.5101362348927434, 1.5558397961197208, 1.6027512040297112, 1.6509053264694051, 1.7003382605488855, 1.7510873761620491, 1.8031913602188279, 1.8566902614571101, 1.911625535675816, 1.96804009120063, 2.02597833436, 2.0854862147108473, 2.146611269710409, 2.2094026684824097, 2.273911254271805, 2.3401895851219665, 2.4082919722411438, 2.478274515450383, 2.550195135022615, 2.6241135991315176, 2.7000915460285477, 2.7781924999567886, 2.8584818796905007, 2.941026998459015, 3.0258970538730603, 3.1131631063203167, 3.202898044135515, 3.295176533679213, 3.3900749522792943, 3.487671301801944, 3.588045100426188, 3.691277250000748, 3.7974498761677578, 3.9066461382491933, 4.018950005714313, 4.134445997887301, 4.253218883421875, 4.3753533359739025, 4.500933542456286, 4.630042760275809, 4.762762820044897, 4.8991735704503565, 5.039352262264308, 5.183372868921367, 5.331305341681653, 5.483214798173484, 5.639160644084504, 5.7991956289648625, 5.963364838537254, 6.131704627588275, 6.304241499447342, 6.480990940238201, 6.661956218496793, 6.847127163355442, 7.036478937247236, 7.229970821917764, 7.427545039353249, 7.629125631933183, 7.834617428560112, 8.043905125557965, 8.256852512600805, 8.471386239943127, 8.68964464430325, 8.91098810736159, 9.13521313517426, 9.362569368724644, 9.593773692302552, 9.830021132622477, 10.072992289330085, 10.324857010140123, 10.58827389221311, 10.866384944921993, 11.162804402977159, 11.481600274499616, 11.827266807408327, 12.204685730033276, 12.619073939272099, 13.075915339657797, 13.58087484283168, 14.139693174136813, 14.758062136900769, 15.441481354796208, 16.19509919507527, 17.02354245475789, 17.930741291710138, 18.919757580642077, 19.992626128180373, 21.15021876387084, 22.392141060489593, 23.716670240300406, 25.120740719144226, 26.59998087352635, 28.14880124257469, 29.760530830845404, 31.427594826620616, 33.14172424205463, 34.89418599725105, 36.67602098662119, 38.478277735603726, 40.29223030908792, 42.109570995682866, 43.922570718079456, 45.72420282902408, 47.508228668899996, 49.26924574489563, 51.00270146224551, 52.70487688392005, 54.372845975397276, 56.00441622637067, 57.59805649924848, 59.15281753306003, 60.66824984223378, 62.14432290291779, 63.58134861351844, 64.97991113089981, 66.34080437781292, 67.66497782798871, 68.95349062141881, 70.20747364673757, 71.4280989419675, 72.61655559331119, 73.77403123414793, 74.90169824157498, 76.00070377512432, 77.07216288326336, 78.1171540025331, 79.13671627961159, 80.13184824942219, 81.10350749682867, 82.05261101217613, 82.98003602061311, 83.88662112185187, 84.7731676218121, 85.64044097197693, 86.489172258014, 87.32005969799727, 88.13377012397267, 88.93094042998486, 89.71217897610998, 90.47806694237156, 91.22915962929397, 91.96598770373538, 92.68905838986628, 93.39885660595075, 94.09584604809312, 94.78047022243281, 95.45315342747155, 96.1143016883376, 96.76430364485819, 97.40353139534174, 98.03234129797531, 98.6510747317258, 99.2600588186055, 99.85960710912033, 100.45002023267166, 101.03158651462857, 101.604582561728, 102.16927381740007, 102.72591508855241, 103.2747510452832, 103.81601669492937, 104.3499378317925, 104.8767314638222, 105.39660621747623, 105.90976272191578, 106.41639397363762, 106.9166856825882, 107.41081660075034, 107.8989588341431, 108.38127813912386, 108.85793420383509, 109.32908091559347, 109.794866614975, 110.2554343373089, 110.71092204225461, 111.16146283209889, 111.60718515937423, 112.04821302436788, 112.48466616305817, 112.91666022598551, 113.34430694853714, 113.76771431309828, 114.18698670349713, 114.60222505214685, 115.01352698026646, 115.42098693154034, 115.82469629955631, 116.22474354934404, 116.62121433331721, 117.01419160190588, 117.40375570915072, 117.789984513515, 118.17295347415629, 118.5527357428872, 118.92940225204146, 119.30302179844982, 119.67366112371982, 120.04138499100243, 120.40625625841857, 120.76833594931014, 121.12768331947052, 121.48435592150123, 121.83840966643467, 122.18989888275424, 122.53887637293674, 122.88539346763586, 123.2295000776185, 123.57124474356021, 123.91067468380109, 124.2478358401571, 124.58277292187786, 124.91552944783693, 125.24614778703626, 125.57466919750199, 125.90113386364565, 126.2255809321604, 126.5480485465186, 126.86857388013385, 127.18719316824746, 127.50394173859634, 127.81885404091608, 128.13196367533124, 128.4433034196814, 128.75290525582972, 129.0608003949982, 129.36701930217214, 129.6715917196133, 129.97454668952082, 130.27591257587568, 130.57571708550358, 130.87398728838932, 131.17074963727427, 131.4660299865666, 131.75985361059338, 132.0522452212214, 132.343228984873, 132.63282853896175, 132.92106700777157, 133.20796701780196, 133.49355071260112, 133.77783976710728, 134.06085540151824, 134.34261839470773, 134.6231490972069, 134.90246744376765, 135.18059296552485, 135.45754480177268, 135.7333417113704, 136.0080020837919, 136.28154394983278, 136.55398499198833, 136.82534255451458, 137.09563365318522, 137.36487498475535, 137.63308293614352, 137.9002735933426, 138.16646275006983, 138.4316659161655, 138.6958983257502, 138.95917494514896, 139.2215104805918, 139.4829193856981, 139.74341586875352, 140.00301389978657]
W=[0.0, -0.040482914867162816, -0.08296799563991629, -0.12746678661129088, -0.1739913727783537, -0.2225543834134207, -0.2731689957997563, -0.32584893913229784, -0.3806084985839518, -0.43746251953810056, -0.49642641198802895, -0.5575161551039789, -0.6207483019686624, -0.686139984482127, -0.7537089184368669, -0.8234734087642606, -0.8954523549533712, -0.9696652566433062, -1.0461322193904077, -1.1248739606115754, -1.205911815705171, -1.2892677443510545, -1.374964336991334, -1.463024821493574, -1.55347306999833, -1.6463336059528852, -1.7416316113333417, -1.839392934057174, -1.9396440955885919, -2.0424122987391793, -2.1477254356663353, -2.2556120960722565, -2.3661015756063652, -2.4792238844741257, -2.595009756255453, -2.7134906569360693, -2.8346987941552304, -2.9586671266735114, -3.0854293740645056, -3.215020026634371, -3.347474355573428, -3.4828284233441953, -3.621119094310329, -3.762384045611206, -3.906661778287094, -4.053991628659905, -4.204413779974828, -4.357969274308316, -4.514700024747976, -4.674648827850154, -4.837859376381252, -5.004376272348763, -5.174245040328348, -5.347512141093408, -5.5242249855535475, -5.704431949008733, -5.888182385725764, -6.075526643843916, -6.266516080616726, -6.461203077996659, -6.659641058569786, -6.86188450184721, -7.067988960920145, -7.278011079485466, -7.49200860924822, -7.710040427707599, -7.932166556332581, -8.15844817913312, -8.388947661632399, -8.623728570245337, -8.862855692067958, -9.106395055081597, -9.354413948775422, -9.606980945189818, -9.864165920382298, -10.12604007631683, -10.392675963175964, -10.664147502094295, -10.940530008310008, -11.221900214729967, -11.508336295901831, -11.799917892384865, -12.09672613550879, -12.398843672507796, -12.706354692014054, -13.019344949892105, -13.337901795392437, -13.662114197598864, -13.99207277214043, -14.327869808134405, -14.669599295322099, -15.017356951354214, -15.371240249176667, -15.73134844446188, -16.097782603023653, -16.470645628146368, -16.850042287751474, -17.236079241315174, -17.628865066441925, -18.028510284987803, -18.43512738861658, -18.848830863658947, -19.26973721513179, -19.697964989760013, -20.133634797827256, -20.576869333664533, -21.027793394567166, -21.486533897909563, -21.953219896205376, -22.427982589836045, -22.910955337144685, -23.402273661563367, -23.902075255410804, -24.410499979963802, -24.92768986136898, -25.45378908192136, -25.988943966193553, -26.53330296145185, -27.087016611745142, -27.650237524996996, -28.223120332371796, -28.805821639120808, -29.398499966043904, -30.001315680626906, -30.614430916832074, -31.23800948243048, -31.872216752669143, -32.517219548961734, -33.17318600118008, -33.84028539200253, -34.51868798164576, -35.20856481116614, -35.91008748236629, -36.6234279121814, -37.34875805924569, -38.08624962015467, -38.83607369273962, -39.598400403459756, -40.37339849579151, -41.16123487625501, -41.962074114464095, -42.77607789331805, -43.60340440517047, -44.4442076895151, -45.29863690741857, -46.16683554760896, -47.04894055879688, -47.94508140246564, -48.85537902002082, -49.77994470784093, -50.718878893425355, -51.67226980549641, -52.640192030589795, -53.62270494836509, -54.61985103760111, -55.631654044617015, -56.65811700569535, -57.69922011499513, -58.75491842945026, -59.8251394022727, -60.90978023695162, -62.0087050540836, -63.12174186402515, -64.24867933926312, -65.38926338159501, -66.54319348075106, -67.71011886302463, -68.88963443086503, -70.08127649729279, -71.28451832248561, -72.4987654640205, -73.72335095711786, -74.9575303468788, -76.20047660100079, -77.45127493885587, -78.70891762115522, -79.97229875372419, -81.24020916917144, -82.5113314614025, -83.78423525992436, -85.05737284356483, -86.32907520638163, -87.59754870187608, -88.86087240477977, -90.11699634217398, -91.36374075695991, -92.59879657603281, -93.81972726213732, -95.02397223141583, -96.20885201714631, -97.37157535310627, -98.50924833640383, -99.61888580855322, -100.6974250642429, -101.74174195908003, -102.74866944032178, -103.71501846837484, -104.63832271144479, -105.5155237887836, -106.34276784567942, -107.11702772368312, -107.83595723582675, -108.49772555112395, -109.1008318461846, -109.64390290973749, -110.12547905791801, -110.54379629985354, -110.8965748516752, -111.18082546903933, -111.39268535977668, -111.52729452813257, -111.57872140019217, -111.53994380672644, -111.40288828530515, -111.15852761297158, -110.79703376412206, -110.30798120236425, -109.68059351934049, -108.90402482697516, -107.96766590868471, -106.86146392142444, -105.57624347191447, -104.10401628248168, -102.43826655321807, -100.57419964133318, -98.50894289221576, -96.24168937740424, -93.77377785197648, -91.10870529320856, -88.25207171998402, -85.2114603785785, -81.99625956650063, -78.61743512170136, -75.08726474074756, -71.41904667571481, -67.62679593190013, -63.724940851605425, -59.72803199069338, -55.65047359403068, -51.50628591091542, -47.30890424164573, -43.071018156428174, -38.80445195265486, -34.52008526760932, -30.22781095870808, -25.936525980340566, -21.654150061117363, -17.38766651366122, -13.143179452159815, -8.925981985484036, -4.740630513643881, -0.5910209936363957, 3.51953612953635, 7.588244787111342, 11.612757611264499, 15.591116683974336, 19.52170109336706, 23.403181232496504, 27.234479456568238, 31.01473651250064, 34.74328305056973, 38.419615500048145, 42.04337561757276, 45.61433307883067, 49.13237056469622, 52.59747087964125, 56.00970572427578, 59.369225819785335, 62.67625214706184, 65.93106811667109, 69.1340125280343, 72.2854732086249, 75.38588124824571, 78.43570576125532, 81.43544912248683, 84.38564263185857, 87.2868425693593, 90.13962660698826, 92.94459054791665, 95.70234536602202, 98.41351452129827, 101.0787315286352, 103.69863775921559, 106.27388045535491, 108.80511094105196, 111.29298301185712, 113.73815148890975, 116.14127092315248, 118.50299443681723, 120.82397269028137, 123.10485296333434, 125.34627834076859, 127.5488869930167, 129.71331154331105, 131.8401785135383, 133.93010784160253, 135.98371246370948, 138.00159795553026, 139.98436222671185, 141.93259526366765, 143.84687891600893, 145.7277867223785, 147.57588377180673, 149.39172659704533, 151.1758630966446, 152.92883248281757, 154.65116525239443, 156.34338317841056, 158.00599932008546, 159.6395180491509, 161.24443509067117, 162.8212375766637, 164.3704041109812, 165.89240484406088, 167.3877015562701, 168.85674774869966, 170.29998874036013, 171.71786177083854, 173.11079610756073, 174.4792131568867, 175.82352657834417, 177.144142401372, 178.44145914400787, 179.71586793301478, 180.96775262499045, 182.1974899280521, 183.40544952373475, 184.59199418877864, 185.75747991651818, 186.90225603761905, 188.02666533993943, 189.13104418731731, 190.21572263711408, 191.28102455636406, 192.32726773640107, 193.35476400585333, 194.36381934191294, 195.3547339798017, 196.32780252037034, 197.2833140357796, 198.2215521732217, 199.14279525665404, 200.047316386523, 200.9353835374648, 201.80725965397892, 202.66320274407445, 203.5034659708955, 204.32829774233863, 205.13794179867824, 205.93263729821922, 206.7126189010022, 207.4781168505867, 208.22935705394224, 208.9665611594781, 209.68994663324574, 210.39972683334815, 211.09611108259176, 211.7793047394186, 212.44950926715578, 213.10692230162033, 213.7517377171183, 214.38414569087638, 215.00433276594447, 215.61248191260802, 216.208772588348, 216.7933807963862, 217.36647914285322, 217.92823689261613, 218.478820023801, 219.01839128104686, 219.54711022752468, 220.06513329575552, 220.57261383726083, 221.06970217107724, 221.5565456311661, 222.03328861274917, 222.5000726175991, 222.95703629831297, 223.40431550159695, 223.84204331058814, 224.27035008623898, 224.68936350778935, 225.09920861234997, 225.50000783361926, 225.89188103975658, 226.274945570432, 226.64931627307345, 227.01510553832986, 227.3724233347695, 227.7213772428309, 228.06207248804304, 228.39461197353168, 228.7190963118266, 229.035623855985, 229.34429073004478, 229.64519085882168, 229.93841599706244, 230.22405575796662, 230.50219764108897, 230.77292705963254]

#c0fuel=Pi*X0/(Ru*Ti) #[Pa][gmol/gmol]/[J/molK][K] = [gmol/m3]
#c0O2=Pi*X0*OC/(Ru*Ti)
#c0N2=c0O2*3.76
#lista1,lista2,lista3,lista4,lista5=[c0fuel*10**-6],[c0O2*10**-6],[0],[0],[0]
#massFraction=[]
#
#next_concentration=[c0fuel*10**-6,c0O2*10**-6,0,0,0,c0N2*10**-6]
tig = find_nearest(tk,radians(-28))

c0fuel=mols_c/volume(tk[len(ti)])
c0O2=mols_c/volume(tk[len(ti)])*OC
c0N2=mols_c/volume(tk[len(ti)])*OC*3.76
next_concentration = [c0fuel*10**-3,c0O2*10**-3,0,0,0,c0N2*10**-3]

lista1,lista2,lista3,lista4,lista5=[c0fuel*10**-3],[c0O2*10**-3],[0],[0],[0]
massFraction=[]


 #calcula x e dt por cinetica usando as temperaturas corretas
for t in range(len(ti),len(ti)+len(tj)-1):
    Tt=wiebeTemperature1000[t]
    Pt=wiebePressure1000[t]
     
    xt,dxdt,concentration,molar_comp = twoStepKinects(next_concentration,[tk[t],tk[t+1]],Tt,Pt)
   
    next_concentration = concentration
    lista1.append(next_concentration[0])
    lista2.append(next_concentration[1])
    lista3.append(next_concentration[2])
    lista4.append(next_concentration[3])
    lista5.append(next_concentration[4])
    
    massFraction.append(xt)


tjd = [degrees(j)for j in tj]
plt.plot(tjd,lista1,label='C2H5OH')
plt.plot(tjd,lista2,label='O2')
plt.plot(tjd,lista3,label='CO')
plt.plot(tjd,lista4,label='CO2')
plt.plot(tjd,lista5,label='CH2O')
plt.legend()
plt.show()

m,a=1,2
def wiebed(teta):
    return 1-exp(-a*((teta-teta_combd)/delta_tetad)**(m+1))  
 
wiebeMassFraction12 = [wiebed(te) for te in tjd[:-1]] 
m,a=2,5
wiebeMassFraction25 = [wiebed(te) for te in tjd[:-1]] 
m,a=5,50
wiebeMassFraction560 = [wiebed(te) for te in tjd[:-1]] 
def wiebefit(teta,a,m):
    return 1-np.exp(-a*((teta-teta_combd)/delta_tetad)**(m+1))

ax = plt.axes()
ax.set_ylabel('x()',fontsize='x-large')
ax.set_xlabel('[]',fontsize='x-large',loc='right')
plt.plot(tjd[:-1],massFraction,color='black',label='Westbrook and Dryer')
plt.plot(tjd[:-1],wiebeMassFraction12,'--',color='black',label='Wiebe m=1,a=2')
plt.plot(tjd[:-1],wiebeMassFraction25,':',color='black',label='Wiebe m=2,a=5')
plt.plot(tjd[:-1],wiebeMassFraction560,'-.',color='black',label='Wiebe m=5,a=50')
plt.legend()
plt.show()
plt.savefig("resultados/massfractionAlcool",bbox_inches='tight')




from edos import motorComb,volume
tk=np.linspace(teta0,tetaf,400)
ti=tk[:find_nearest(tk,teta_comb)]
tj=tk[find_nearest(tk,teta_comb):find_nearest(tk,teta_comb+delta_teta)]
tf=tk[find_nearest(tk,teta_comb+delta_teta):]
#calcula temperaturas pelo sistema
tetaS=teta_comb
spark=0
Spark = signal.unit_impulse(len(tk),find_nearest(tk,tetaS))*spark

P0=wiebePressure[0]
T0=wiebeTemperature[0]
Qa0=0
Qp0=0
W0=0

P=np.ones(len(tk))*P0
T=np.ones(len(tk))*T0
P1=[67490.0, 67605.31715299033, 67726.48585637011, 67853.56102918337, 67986.60041897571, 68125.6646494179, 68270.81727046469, 68422.12481111193, 68579.6568348209, 68743.48599768164, 68913.68810939085, 69090.34219712409, 69273.53057238746, 69463.33890093573, 69659.85627585069, 69863.17529387769, 70073.39213512224, 70290.60664621576, 70514.92242706212, 70746.4469212849, 70985.29151049892, 71231.57161253723, 71485.40678377144, 71746.92082566574, 72016.24189571921, 72293.50262295085, 72578.84022809402, 72872.39664867263, 73174.31866914198, 73484.75805628161, 73803.87170004111, 74131.82176004742, 74468.77581799039, 74814.90703611716, 75170.39432207325, 75535.42250034315, 75910.18249055183, 76294.87149290284, 76689.6931810428, 77094.85790265322, 77510.58288808653, 77937.09246737871, 78374.6182959862, 78823.39958961091, 79283.6833684966, 79755.72471159496, 80239.78702102193, 80736.14229724399, 81245.07142545634, 81766.86447363265, 82301.82100275825, 82850.25038977314, 83412.4721637846, 83988.81635613416, 84579.62386492743, 85185.24683467475, 85806.04905171279, 86442.4063561144, 87094.70707083259, 87763.3524488488, 88448.75713915062, 89151.3496723884, 89871.57296711371, 90609.88485754082, 91366.75864382552, 92142.68366589013, 92938.16590189576, 93753.7285925008, 94589.91289210733, 95447.27854835446, 96326.40461118604, 97227.89017287703, 98152.35514047841, 99100.4410422112, 100072.81186941487, 101070.1549557333, 102093.18189531191, 103142.62950185996, 104219.2608105253, 105323.86612462778, 106457.26410939508, 107620.30293495259, 108813.86147092191, 110038.85053511392, 111296.21419890295, 112586.93115200622, 113912.01612952027, 115272.521404205, 116669.53834714548, 118104.19906007028, 119577.67808276044, 121091.19417913769, 122646.01220579576, 124243.44506689599, 125884.85575954305, 127571.6595139196, 129305.32603265614, 131087.38183410483, 132919.41270438745, 134803.06626326364, 136740.0546491021, 138732.15732842562, 140781.22403569252, 142889.17784922346, 145058.01840934707, 147289.8252850601, 149586.76149568736, 151951.07719421564, 154385.11351916008, 156891.3066219605, 159472.19187707122, 162130.40828203037, 164868.70305485424, 167689.9364362003, 170597.08670374018, 173593.2554061407, 176681.6728239705, 179865.70366469643, 183148.8529986668, 186534.77244264554, 190027.2665970407, 193630.29974233097, 197348.00279951925, 201184.68055850305, 205144.81917717127, 209233.09395267774, 213454.37736476274, 217813.74738909665, 222316.49607637062, 226968.1383902165, 231774.42129396464, 236741.33307268203, 241875.11287268566, 247182.2604360012, 252669.54600162958, 258344.0203390554, 264213.0248721604, 270284.201843288, 276565.5044575945, 283065.20693694596, 289791.91440022347, 296754.57247281185, 303962.4765121546, 311425.2803183344, 319153.0041783638, 327156.04207017913, 335445.1678268577, 344031.54003307, 352926.70539406576, 362142.6002820475, 371691.5501258578, 381586.2662663419, 391839.83985235554, 402465.7323000615, 413477.76178121276, 424890.08514407225, 436717.1746039776, 448973.7884686982, 461674.9350873879, 474835.8291313607, 488471.8392307207, 502598.4259041989, 517231.06863127527, 532385.1808282672, 548076.0114051924, 564318.5315011712, 581127.304926523, 598516.3407841775, 616498.9267066331, 635087.4411349648, 654293.1430899462, 674125.9379523958, 694594.117890042, 715704.075753293, 737459.9915263838, 759863.4907753606, 782913.2749978716, 806604.72436462, 830929.4740652175, 855874.9663446342, 881423.9813524762, 907554.1511333627, 934237.4624641697, 961439.7557877518, 989120.2291866533, 1017230.9581556446, 1045716.4438270034, 1074513.2042140514, 1103549.4248887552, 1132744.6871969302, 1162009.7935193554, 1191246.7100700503, 1220348.6481310008, 1249200.304294429, 1277678.2790600823, 1305651.6908694447, 1332982.9992349285, 1359529.045967323, 1385142.3176104282, 1409672.4251286574, 1432967.788824495, 1454877.5076537617, 1475253.3829251875, 1493952.0572762473, 1510837.2213437255, 1525781.8332674159, 1538670.2906547622, 1549400.4914141926, 1557885.719363103, 1564056.2930034432, 1567860.9214224536, 1569267.7197886775, 1568264.848026591, 1564860.7494173537, 1559083.9803707346, 1550982.6376181007, 1540623.4037188736, 1528090.2452142932, 1513482.8092632156, 1496914.5735736734, 1478510.8105175223, 1458406.4293190476, 1436743.7601927023, 1413670.341515817, 1389336.7659603208, 1363894.6344856734, 1337494.6587809757, 1310284.9437150783, 1282409.4721522033, 1254006.805591039, 1225209.005870474, 1196140.7759398315, 1166918.8115930234, 1137651.3512026863, 1108437.9068628314, 1079369.157896541, 1050526.9862960519, 1021984.6331951763, 993806.9557698854, 966050.7648604809, 938765.2249527925, 911992.2998052208, 885767.2288387544, 860119.021315017, 835070.9572293785, 810641.0856787836, 786842.7131804255, 763684.875987875, 741172.7918571279, 719308.2879502263, 698090.2026278334, 677514.7597825549, 657575.9151118849, 638265.6743365696, 619574.3838530661, 601490.9946809914, 584003.3008446615, 567098.1535252635, 550761.6524503757, 534979.3160629096, 519736.23204150907, 505017.1897398147, 490806.7960797092, 477089.576380737, 463850.06154033134, 451072.86290196626, 438742.73606386443, 426844.63479403174, 415363.7561290301, 404285.5776467841, 393595.8878191675, 383280.8102687366, 373326.82267696655, 363720.7710187673, 354449.87973035336, 345501.7583549003, 336864.4051525772, 328526.2081083769, 320475.94372304255, 312702.7739282149, 305196.2414271537, 297946.2637264395, 290943.1260917338, 284177.47363164905, 277640.3026877735, 271322.9516858423, 265217.0915822782, 259314.7160221407, 253608.13130816273, 248089.94626633046, 242753.0620806668, 237590.66215882968, 232596.20208029347, 227763.3996703148, 223086.22523536516, 218558.89198918984, 214175.84669293763, 209931.7605278792, 205821.52021496213, 201840.2193917366, 197983.15025407632, 194245.7954673611, 190623.8203495113, 187113.06532630528, 183709.5386577527, 180409.409432947, 177209.0008296625, 174104.78363401387, 171093.37001478625, 168171.50754636744, 165336.07347381004, 162584.06921314588, 159912.6150798495, 157318.94523814303, 154800.40286375786, 152354.43551270594, 149978.5906886303, 147670.51160136136, 145427.9331093718, 143248.67783896657, 141130.6524731597, 139071.8442033617, 137070.31733718296, 135124.21005581706, 133231.73131469046, 131391.15788125928, 129600.8315040187, 127859.15620702828, 126164.59570442988, 124515.67092967345, 122910.95767434167, 121349.08433167692, 119828.72974012222, 118348.62112235455, 116907.53211550397, 115504.28088841125, 114137.72834198063, 112806.776388825, 111510.3663085993, 110247.47717554918, 109017.12435498138, 107818.35806549518, 106650.26200395807, 105511.95203036671, 104402.57490982742, 103321.3071090587, 102267.35364491477, 101239.9469825451, 100238.34598093251, 99261.83488363662, 98309.72235268813, 97381.34054367163, 96476.04422011955, 95593.2099054373, 94732.23507066022, 93892.5373564237, 93073.55382759988, 92274.74025913855, 91495.5704517053, 90735.5355757866, 89994.14354299044, 89270.91840333039, 88565.39976734234, 87877.14225193011, 87205.71494889868, 86550.70091517155, 85911.69668374528, 85288.31179447226, 84680.16834381095, 84086.90055271915, 83508.15435190448, 82943.58698368756, 82392.8666197622, 81855.67199417672, 81331.69205088429, 80820.6256052484, 80322.18101891209, 79836.0758874726, 79362.03674042289, 78899.79875284938, 78449.1054684029, 78009.70853307204, 77581.36743932127, 77163.84928016743, 76756.92851279407, 76360.38673131423, 75974.01244832101, 75597.60088486847, 75230.95376855339, 74873.87913937678, 74526.19116307973, 74187.70995166474, 73858.26139082246, 73537.67697400278, 73225.79364287105, 72922.45363391537, 72627.50433096812, 72340.79812342604, 72062.19226995559, 71791.54876748582]
x0=[P0,T0,Qa0,Qp0,W0] #condicoes iniciais

c0fuel=P0*X0/(Ru*T0) #[Pa][gmol/gmol]/[J/molK][K] = [gmol/m3]
c0O2=P0*X0*OC/(Ru*T0)
c0N2=c0O2*3.76
concentration0=[c0fuel*10**-6,c0O2*10**-6,0,0,0,c0N2*10**-6]
t0=radians(-164)
#c0fuel=mols_c/volume(t0)
#c0O2=mols_c/volume(t0)*OC
#c0N2=mols_c/volume(t0)*OC*3.76
#concentration0 = [c0fuel*10**-6,c0O2*10**-6,0,0,0,c0N2*10**-6]


print(m_c)
massFraction2=np.zeros(len(tk))

for t in range(len(tk)-1):
    
    xt,dxdt,concentration,molar_comp = twoStepKinects(concentration0,[tk[t],tk[t+1]],T[t],P[t])
    
    x=solve_ivp(motorComb,[tk[t],tk[t+1]],x0,args=(P1[t],xt,dxdt,Spark[t]),method='DOP853').y
    concentration0=concentration
    #print(xt)
    P[t+1]=x[0][-1]
    T[t+1]=x[1][-1]
    
    massFraction2[t+1]=xt
    x0=[x[0][-1],x[1][-1],x[2][-1],x[3][-1],x[4][-1]]


tkd = [degrees(k)for k in tk]
ax = plt.axes()
ax.set_ylabel('x()',fontsize='x-large')
ax.set_xlabel('[]',fontsize='x-large',loc='right')
plt.plot(tkd,massFraction2)

